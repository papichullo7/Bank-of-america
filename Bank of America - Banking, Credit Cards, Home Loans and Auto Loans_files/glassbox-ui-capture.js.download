var gb_currentHostname=window.location.hostname,gb_hostnameParts=gb_currentHostname.split('.bankofamerica.com');if(gb_hostnameParts.length>1&&(gb_hostnameParts[0].indexOf('www')>-1||gb_hostnameParts[0].indexOf('secure')>-1)){window._cls_config={reportURI:'/pa/global-assets/1.0/graphic/clr.gif',recordErrors:true,recordHovers:true,recordScrolls:true,recordConsoleErrors:true,recordMouseMoves:false,idleEventTimeInterval:-1,maskClassList:['tl-private','TL_NPI_L1','TL_NPI_L2'],reportInterval:10000};!function(e,t,n,r){function o(){var e=[];this.add=function(t,n,r,o,i,a){this[i.toLowerCase()]={type:t,nullable:n,parser:r,name:i,required:a,validator:o},a&&e.push(i)},this.requiredFieldsMask=function(){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t}}function i(){this.errors=[],this.warnings=[]}function a(e){var t={},n=[];(e=e||this).on=function(e,n,r){(t[e]=t[e]||[]).push([n,r])},e.off=function(e,r){e||(t={});for(var o=t[e]||n,i=o.length=r?o.length:0;i--;)r==o[i][0]&&o.splice(i,1)},e.emit=function(e){for(var r,o=t[e]||n,i=o.length>0?o.slice(0,o.length):o,a=0;r=i[a++];)r[0].apply(r[1],n.slice.call(arguments,1))}}function s(e){this.size=0,this.limit=e,this._keymap={}}function c(e,t,n,r){this.severity=e,this.code=t,this.count=n,r&&(this.msg=r)}function l(e,t,n,r,o){o||(o={}),this.name='FORM-URL',this.supportsCompression=!1,this.isCompressing=function(){return!1},this.visitXhr=function(e){e.setRequestHeader('Content-Type','application/x-www-form-urlencoded')},this.encodeSnapshotHtml=function(e){return o.domCompress?{encoded:n.Base64.bytesToBase64(r.compress(e)),plain:!1,compressed:!0}:{encoded:n.Base64.encode(e),plain:!1,compressed:!1}},this.estimateBeaconSize=function(e){return e},this.encodeEvent=function(i,a){var s,c=t.encoding.delimiters.eventParts,l=r.encodeTimestamp(i),u=r.encodeEventType(i.type),d=e.isUndefined(i.binding)||e.isUndefined(i.binding.valueEncoding)?i.value:i.binding.valueEncoding(i.value);void 0===a&&(a=e.isUndefined(i.selectorExpression)||null==i.selectorExpression?t.encoding.rootSelector:i.selectorExpression);var p=l+c+u+c+a;if(e.isString(d)&&d.length>0?p+=c+(s=i.shouldEncodeValue?t.encoding.valueEncodedPrefix:t.encoding.valueNotEncodedPrefix)+(i.shouldEncodeValue?n.Base64.encode(d):d):p+=c+'-',e.isUndefined(i.extraInfo)?p+=c+'-':p+=c+r.encodeExtraInfo(i),o.reportDebugInfo&&!e.isUndefined(i.debugInfo)?p+=c+r.encodeDebugInfo(i):p+=c+'-',i.domSnapshot){var m;if(s=t.encoding.domSnapshotPrefix,o.domCompress){var g=r.compress(JSON.stringify(i.domSnapshot));m=n.Base64.bytesToBase64(g),s=s.toLowerCase()}else m=n.Base64.encode(JSON.stringify(i.domSnapshot));p+=c+s+m}return n.trace('encoding ('+i.type+') '+(e.contains(['webSocketFrame','resourceContent','pageSnapshot'],i.type)?l+c+u+c+'{event string is too long}':p)+(i.getSubPage().length>0?' [on '+i.getSubPage()+']':'')),encodeURIComponent(p)},this.encodeBeacon=function(e,n,r,o,i,a){return'v='+e+'&sn='+n+'&p='+r+(o.length>0?'&sp='+encodeURIComponent(o):'')+(void 0!==i?'&pssn='+i:'')+'&e='+a.join(t.encoding.delimiters.events)}}function u(e,t,n,r,o){o||(o={});var i=function(e){var t,n=0;for(t in e)'string'==typeof e[t]&&(n+=e[t].length);e.length=n},a=function(e){delete e.length};this.name='JSON',this.supportsCompression=!0,this.isCompressing=function(){return!0},this.visitXhr=function(e){e.setRequestHeader('Content-Type','text/plain'),o.compress&&e.setRequestHeader('Content-Encoding','gzip')},this.encodeSnapshotHtml=function(e){return!o.compress&&o.domCompress?{encoded:n.Base64.bytesToBase64(r.compress(e)),plain:!1,compressed:!0}:{encoded:e,plain:!0,compressed:!1}},this.estimateBeaconSize=function(e){return o.compress?e/2:e},this.encodeEvent=function(a,s){var c={timestamp:r.encodeTimestamp(a),type:''+r.encodeEventType(a.type)};void 0===s&&(s=e.isUndefined(a.selectorExpression)||null==a.selectorExpression?t.encoding.rootSelector:a.selectorExpression),c.selector=s;var l=e.isUndefined(a.binding)||e.isUndefined(a.binding.valueEncoding)?a.value:a.binding.valueEncoding(a.value);if(e.isString(l)&&l.length>0){var u=a.shouldEncodeValue?t.encoding.valueEncodedPrefix:t.encoding.valueNotEncodedPrefix;l=a.shouldEncodeValue?n.Base64.encode(l):l,c.value=u+l}else c.value='-';if(e.isUndefined(a.extraInfo)?c.extraInfo='-':c.extraInfo=r.encodeExtraInfo(a),o.reportDebugInfo&&!e.isUndefined(a.debugInfo)?c.debugInfo=r.encodeDebugInfo(a):c.debugInfo='-',a.domSnapshot){var d=JSON.stringify(a.domSnapshot);if(o.compress)c.domSnapshot=t.encoding.domSnapshotPlainPrefix+d;else if(o.domCompress){var p=r.compress(d);c.domSnapshot=t.encoding.domSnapshotCompressedPrefix+n.Base64.bytesToBase64(p)}else c.domSnapshot=t.encoding.domSnapshotPrefix+n.Base64.encode(d)}else c.domSnapshot='-';return n.trace('json encoding ('+a.type+') '+c.timestamp+';'+c.type+' {event string is too long}'+(a.getSubPage().length>0?' [on '+a.getSubPage()+']':'')),i(c),c},this.encodeBeacon=function(t,i,s,c,l,u){e.forEach(u,a);var d={ver:t,sn:i,pageId:s,events:u};void 0!==c&&c.length>0&&(d.subPage=c),void 0!==l&&(d.pssn=l);var p=JSON.stringify(d);if(o.compress){var m=r.compress(p);return n.log('applying json compression. before:'+p.length+' after:'+m.length+' (ratio:'+m.length/p.length+')'),m}return p}}function d(e){if(e&&0!==e.length){var t=B.immutableSet.apply(null,e),n=function(e,n,r){t[n]&&e.push(n+'='+r)};this.apply=function(e){var t=[];return n(t,'pid',Y.page.id),n(t,'clsid',J.get(w.cookies.session)),n(t,'clsv',J.get(w.cookies.visitor)),e+(-1===e.indexOf('?')?'?':'&')+t.join('&')}}else this.apply=function(e){return e}}function p(e,t,n){this.url=t,this.timestamp=n,this.type=e}function m(e,t){this.x=e,this.y=t}function g(e){this.map={},this.cookieName=e,this.readFromCookie()}function f(e,t,n,r){this.pageId=r,this.timestamp=t,this.type=e,this.element=n,this.report=!0,this.shouldEncodeValue=!0,this.dependent=!1,this.subPage=B.getHashFromUrl(window.location.href)}function v(e,t,n){this.element=e,this.message=t.length>0?t:'NONE',this.selector=n}function h(e){if('object'==typeof console){var t;for(t in e)!function(e,t){if('function'==typeof function(){}){var n=function(){};console[e]=function(){}}}(t,e[t])}}function E(e){this.value=e}function y(e,t){try{if(!e.interception)return void(C.ajaxDebug&&B.trace('AjaxCall - missing cls xhr interception data for url: '+(e.responseURL||'')));this.xhr=e,this.timestamp=t,this.interception=e.interception,this.url=e.interception.url,this.method=e.interception.method}catch(e){}}function b(e,t,n){try{this.id=e,this.event=t,this.timestamp=n}catch(e){}}function T(e,t,n,r){try{this.id=e,this.direction=t,this.payload=n,this.timestamp=r}catch(e){}}function S(e,t,n,r){n=n||'';var o=!function(){if(-1===n.indexOf('://'))return!0;var r=e.createElement('a');return r.href=n,r.hostname===t.hostname&&r.port===t.port&&r.protocol===t.protocol&&'file:'!==t.protocol}(),i=o&&null===B.readCookie(S.READY_COOKIE)?S.STATE.INIT:S.STATE.READY,a=[],s=function(t){t&&(e.cookie=S.READY_COOKIE+'=;path=/;domain='+J.getDefaultDomain());var n=a;a=[],i=S.STATE.READY;for(var r=0;r<n.length;r++)n[r](t)};this.isRequired=function(){return o},this.isReady=function(){return i===S.STATE.READY},this.help=function(e,t){var o,c,l=[];if(i===S.STATE.READY)return B.warn('cors helper was called while in \'ready\' state.'),void s(t);for(o in w.cookies)(c=B.readCookie(w.cookies[o]))&&l.push(w.cookies[o]+'='+c);if(l.length>0){if(a.push(t),i===S.STATE.HELPING)return;i=S.STATE.HELPING;var u=n+'?'+l.join('&'),d=e();d.onreadystatechange=function(){4===d.readyState&&(200===d.status?s(!0):(B.log('failed to execute CORS support request. statusCode:'+d.status),s(!1)))},d.open('GET',r.apply(u),!0),d.withCredentials=!0,d.send()}else B.log('ERROR: could not retain cls cookies (was the TLD configured and detected correctly?)'),s(!1)}}if(void 0===window._detector){var w={};w.version='1.0.2',w.beaconVersion='2',w.eventTypes=['mousedown','mouseup','touchstart','touchend','scroll','change','blur','focusout','keydown','submit','reset','load','unload','ajaxComplete','hashchange','popstate','focus','focusin','mouseenter','mousemove','error','beforeunload','resize'],w.snapshotApplicableEventType=['pageUpdate','change','mousedown','scroll','touchstart','blur','submit','drag','formValidationError','navigation','unload','beforeunload'],w.reportBase64URLs=!1,w.nobelEventTypes=['pageSnapshot'],w.socialNobelEventTypes=['resourceContent'],w.encodeSelectors=!0,w.encodeEventTypes=!0,w.useClassesInSelectors=!1,w.repeatingElementSelector='!',w.encoding={numberBase:36,rootSelector:'-',delimiters:{versionPayload:';',pages:'~~~',events:'~~',eventParts:'~',pageIdEvents:'_'},domSnapshotPrefix:'D',domSnapshotCompressedPrefix:'d',domSnapshotPlainPrefix:'P',valueEncodedPrefix:'E',valueNotEncodedPrefix:'N'},w.cookies={events:'_cls_events',session:'_cls_s',sub_session:'_cls_subs',visitor:'_cls_v',referrer:'_cls_referrer',robot:'_cls_bd',debuginfo:'_cls_di',supportMode:'_cls_sm'},w.maskingAttribute='cls_mask',w.MaskingMode={BlackList:'blacklist',WhiteList:'whitelist'},w.detectorScript=n.currentScript||function(){return window.cls_detector_script_id?n.getElementById(window.cls_detector_script_id):n.querySelector('[data-clsconfig]')}();var C={};C.debugMode=!1,C.traceMode=!1,C.suppressMouseMovesDebug=!0,C.reportByPost=!1,C.timingMode=!1,C.useIdSelectors=!0,C.noIdSelectorsForClassNames=['skull_list'],C.noIdSelectorsForIDs=[],C.noIdSelectorsForAttrs=[],C.useNameInFormSelectors=!1,C.preferNamesInFormSelectors=!1,C.reportValidationErrors=!0,C.supportNativeAutoComplete=!1,C.recordEnterForInputs=!0,C.recordTypingAll=!1,C.recordTypingForAttrs=['bs-typeahead'],C.recordTypingForClasses=['tt-input'],C.recordTypingForIDs=[],C.ignorableElementIds=['cls_logger','cls_logger_tab'],C.idleEventTimeInterval=3e4,C.maxTimeForIdleEvent=42e4,C.validationValueForRenderTime=2e4,C.titleCharsLimit=150,C.recordAjaxCallsAnyway=!1,C.ajaxDebug=!1,C.reportVisualNames=!0,C.visualNameDebug=!1,C.visualName={chatLimit:40,CLS_NAME_ATTR:'cls_vname',filterNamingByTagName:['script','style'],by:{title:!0,alt:!0,ariaLabel:!0,inlineText:!0,placeholder:!0,inputConsts:!0,inputButtonsValue:!0,name:!0,id:!0,parent:!0,child:!0},elementListToCheckParent:['img','span','div'],elementListToCheckChild:['button'],filterInlineTextByTagName:['div','span','td'],filterInlineTextByClassName:[]},C.maskingMode=w.MaskingMode.BlackList,C.maskList=[],C.maskClassList=[],C.recordErrors=!1,C.recordErrors=!1,C.recordConsoleErrors=!1,C.minDragPixels=10,C.botDetection=!0,C.reportDebugInfo=!0,C.DOMBeaconImg=!1,C.reportAllOnUnload=!1,C.maxReportsWithUnload=4,C.truncateEventsWithUnload=!0,C.recordScrolls=!1,C.dependentScroll=!0,C.minStallingScrollTime=3e3,C.scrollDebug=!1,C.recordMouseMoves=!1,C.mmRecordTimes=!1,C.mmDiluteMinPixels=20,C.mmMaxMovesWithUnload=100,C.mmMaxMovesInEventNoTimes=180,C.mmMaxMovesInEventWithTimes=130,C.mmMinStallingMoveTime=1e4,C.mmMaxInMemoryMoves=600,C.mmDebug=!1,C.SCIntegration=!1,C.SCIntegrationURLsContainList=[],C.SCIntegrationKeyList=['pageName','v25','v11','v39'],C.externalIdAttr='',C.recordHovers=!1,C.mhDeepLevel=2,C.mhMaxListSize=10,C.mhMaxInMemeoryHovers=100,C.mhDebug=!1,C.reportHybrid=!1,C.recordWebSocket=!1,C.domRecordEnabled=!1,C.reportAllResourcesLoad=!1,C.ignoreReportResourcesByTagNames=[],C.reportExternalResources=!1,C.reportScriptURLContainList=[],C.reportScriptKeyList=[],C.reportImageURLContainList=[],C.reportImageKeyList=[],C.clsDebug=!0,C.clsDebugCharsLimit=1e3,C.clsDebugMaxReports=2,C.reportEncoding='formUrl',C.reportCompress=!1,C.reportAddUriParams=['pid'],w.setup='beacon',w.eventTypes=['mousedown','mouseup','touchstart','touchend','click','scroll','change','blur','focusout','submit','reset','load','unload','hashchange','popstate','focus','focusin','mouseenter','mousemove','error','keydown','keypress','mouseover','beforeunload','resize'],C.maxReportSize=1900,C.maxPostReportSize=1e4,C.reportInterval=3e3,C.reportPostInterval=1e4,C.postRetry=!0,C.interceptAjax=!0,C.recordAjaxRequest=!0,C.recordWebSocket=!1;var x=',';void 0!==w&&w.detectorScript&&(x=w.detectorScript.getAttribute('data-clsarraydelim')||x);var I={toBoolean:function(e,t){if('TRUE'===e.toUpperCase())return!0;if('FALSE'===e.toUpperCase())return!1;throw'cannot parse boolean from \''+e+'\''},toNumber:function(e){var t=-1==e.indexOf('.')?parseInt(e):parseFloat(e);if(isNaN(t))throw'cannot parse number from \''+e+'\'';return t},toString:function(e){return e},toStringArray:function(e){return null==e?[]:e.split(x)}},A={isArray:function(e){return(Array.isArray?Array.isArray(e):e instanceof Array)?null:'array is expected'},elementsOfType:function(e,t){for(var n=0;n<t.length;n++)if(typeof t[n]!==e)return'array element type mismatch. expected:'+e+' actual:'+typeof t[n];return null},and:function(){var e=arguments;return function(t){for(var n=0;n<e.length;n++){var r=e[n](t);if(null!=r)return r}return null}}};o.prototype.ignore=function(e){this[e.toLowerCase()]={name:e,ignore:!0}},o.newBuilder=function(){var e=new o;return{bool:function(t,n){return e.add('boolean',!1,I.toBoolean,null,t,n),this},num:function(t,n){return e.add('number',!1,I.toNumber,null,t,n),this},str:function(t,n){return e.add('string',!0,I.toString,null,t,n),this},strarray:function(t,n){var r=function(e){return A.elementsOfType('string',e)};return e.add('object',!0,I.toStringArray,A.and(A.isArray,r),t,n),this},ignore:function(t){return e.ignore(t),this},build:function(){return e}}};var N={options:{caseSensitive:!0,errorOnUnknown:!1},validate:function(e,t){var n=new i;if(this.parsingError)return n.addError(N.parsingError),n;t=t||{};var r=e.requiredFieldsMask();for(var o in t)if(t.hasOwnProperty(o)){var a=e[o.toLowerCase()];if(!a){(N.options.errorOnUnknown?n.addError:n.addWarning).call(n,'unknown configuration field',o);continue}if(a.ignore)continue;if(a.name!==o&&N.options.caseSensitive){n.addError('unknown configuration field (did you mean \''+a.name+'\'?).',o),delete r[a.name];continue}var s=t[o];if(null==s){a.nullable||n.addError('value cannot be null, value of '+a.type+' type is expected.',o);continue}if(typeof s!==a.type){n.addError('value type mismatch. expected:'+a.type+' actual:'+typeof s,o);continue}if(a.required&&delete r[a.name],a.validator){var c=a.validator(s);c&&n.addError('value violation, '+c,o)}}for(var l in r)n.addError('missing required field',l);return n},onParsingError:function(e){N.parsingError=e}};i.prototype.addError=function(e,t){this.errors.push({field:t,reason:e})},i.prototype.addWarning=function(e,t){this.warnings.push({field:t,reason:e})},i.prototype.toString=function(){var e=function(e){for(var t='',n=0;n<e.length;n++)return t+='\n'+(e[n].field?'\''+e[n].field+'\': ':'')+e[n].reason;return t},t='\n'+this.errors.length+' error(s):';return t+=e(this.errors),t+='\n'+this.warnings.length+' warning(s):',t+=e(this.warnings)};var R={parse:function(e,t,n,r,o){var i=function(e){return'function'!=typeof String.prototype.trim?e.replace(/^\s+|\s+$/g,''):e.trim()};e=e||{};for(var a=null!=n?n.split(t):[],s=0;s<a.length;s++){var c=a[s].split('=');if(2==c.length){var l,u=i(c[0]),d=i(c[1]),p=e[u.toLowerCase()];p?void 0===(l=p.parser)&&(l=I.toString):l=I.toString;try{r[u]=l(d)}catch(e){o&&o('\''+u+'\': '+e)}}}}},M=o.newBuilder().ignore('injectionTime').ignore('visualName').ignore('detectionScriptURI').str('reportURI',!0).bool('recordMouseMoves',!1).bool('recordScrolls',!1).bool('recordErrors',!1).bool('reportValidationErrors',!1).num('idleEventTimeInterval',!1).bool('botDetection',!1).bool('recordHovers',!1).bool('reportByPost',!1).num('maxPostReportSize',!1).num('reportPostInterval',!1).bool('postRetry',!1).bool('interceptAjax',!1).bool('recordAjaxRequest',!1).bool('ajaxDebug',!1).bool('recordWebSocket',!1).bool('DOMBeaconImg',!1).num('reportInterval',!1).bool('reportAllOnUnload',!1).num('maxReportSize',!1).strarray('maskList',!1).strarray('maskClassList',!1).str('externalIdAttr',!1).bool('useIdSelectors',!1).bool('useNameInFormSelectors',!1).bool('preferNamesInFormSelectors',!1).strarray('noIdSelectorsForClassNames',!1).strarray('noIdSelectorsForIDs',!1).strarray('noIdSelectorsForAttrs',!1).bool('SCIntegration',!1).strarray('SCIntegrationURLsContainList',!1).strarray('SCIntegrationKeyList',!1).bool('reportAllResourcesLoad',!1).bool('reportExternalResources',!1).strarray('ignoreReportResourcesByTagNames',!1).strarray('reportScriptURLContainList',!1).strarray('reportScriptKeyList',!1).strarray('reportImageURLContainList',!1).strarray('reportImageKeyList',!1).bool('debugMode',!1).bool('traceMode',!1).bool('suppressMouseMovesDebug',!1).bool('visualNameDebug',!1).bool('timingMode',!1).num('maxReportsWithUnload',!1).num('minDragPixels',!1).bool('reportVisualNames',!1).num('titleCharsLimit',!1).num('maxTimeForIdleEvent',!1).num('validationValueForRenderTime',!1).bool('reportDebugInfo',!1).bool('supportNativeAutoComplete',!1).bool('recordEnterForInputs',!1).bool('recordTypingAll',!1).strarray('recordTypingForAttrs',!1).strarray('recordTypingForClasses',!1).strarray('recordTypingForIDs',!1).num('mmMaxMovesWithUnload',!1).num('mmMaxMovesInEventNoTimes',!1).num('mmMaxMovesInEventWithTimes',!1).num('mmMinStallingMoveTime',!1).num('mmMaxInMemoryMoves',!1).bool('mmDebug',!1).num('mhDeepLevel',!1).num('mhMaxListSize',!1).num('mhMaxInMemeoryHovers',!1).bool('mhDebug',!1).bool('dependentScroll',!1).num('minStallingScrollTime',!1).bool('scrollDebug',!1).bool('clsDebug',!1).num('clsDebugCharsLimit',!1).num('clsDebugMaxReports',!1).bool('domRecordEnabled',!1).strarray('domNewPageTriggers',!1).strarray('pageSnapshotTriggers',!1).num('domStartAfter',!1).num('domUpdateEveryWsMsgIn',!1).num('domRecordEnabledByChance',!1).str('domReportURI',!1).bool('domCompress',!1).strarray('domNewPageAjaxTriggers',!1).strarray('domIgnoredFormElements',!1).bool('semiDomEnabled',!1).strarray('ignorableElementIds',!1).bool('recordAjaxCallsAnyway',!1).bool('truncateEventsWithUnload',!1).bool('mmRecordTimes',!1).num('mmDiluteMinPixels',!1).bool('reportHybrid',!1).str('customTLD',!1).num('enabledByChance',!1).strarray('domCloningBannedIds',!1).strarray('domCloningBannedClasses',!1).str('reportEncoding',!1).bool('reportCompress',!1).str('maskingMode',!1).strarray('reportAddUriParams',!1).bool('recordConsoleErrors',!1).build(),D='undefined'!=typeof _cls_config?_cls_config:'undefined'!=typeof _config?_config:{};if(w.detectorScript){var L=w.detectorScript.getAttribute('data-clsdelim')||';',O=w.detectorScript.getAttribute('data-clsconfig');O&&R.parse(M,L,O,D,N.onParsingError)}for(var _ in D)D.hasOwnProperty(_)&&(C[_]=D[_]);if(void 0!==C.enabledByChance){var U=!0,F=function(e,t){var n,r,o,i=t+'=',a=e.cookie.split(';');for(n=0;n<a.length;n++)if(r=a[n],-1!==(o=r.indexOf(i)))return r.substring(o+i.length,r.length);return null}(n,'_cls_record_enabled');null===F?(U=Math.random()<C.enabledByChance,n.cookie='_cls_record_enabled='+U):U='true'===F,U||(w.disabled=!0)}if(!C.domRecordEnabled&&'undefined'!=typeof domByChanceConfigFactory){var P=domByChanceConfigFactory(n,{chance:C.domRecordEnabledByChance,reportURI:C.domReportURI});for(var _ in P)P.hasOwnProperty(_)&&(C[_]=P[_])}var H=function(e,t){function n(e,t,n){n=(n||0)-1;for(var r=e?e.length:0;++n<r;)if(e[n]===t)return n;return-1}function r(){return N.pop()||{a:'',b:null,c:'',k:null,configurable:!1,enumerable:!1,false:!1,d:'',e:'',v:null,g:'',null:!1,number:null,z:null,push:null,h:null,string:null,i:'',true:!1,undefined:!1,j:!1,writable:!1}}function o(){}function i(e){e.length=0,A.length<M&&A.push(e)}function a(e){var t=e.k;t&&a(t),e.b=e.k=e.object=e.number=e.string=null,N.length<M&&N.push(e)}function s(){}function c(e,t,n){if('function'!=typeof e)return I;if(void 0===t)return e;var r=e.__bindData__||me.funcNames&&!e.name;if(void 0===r){var o=L&&Q.call(e);me.funcNames||!o||D.test(o)||(r=!0),(me.funcNames||!r)&&(r=!L||L.test(o),ge(e,r))}if(!0!==r&&r&&1&r[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,i){return e.call(t,n,r,o,i)};}return x(e,t)}function l(e,t,n,r,o,a){if(n&&void 0!==(p=n(e,t)))return!!p;if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&z[typeof e]||t&&z[typeof t]))return!1;if(null==e||null==t)return e===t;var s=te.call(e),c=te.call(t);if(s==_&&(s=B),c==_&&(c=B),s!=c)return!1;switch(s){case F:case P:return+e==+t;case j:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case V:case W:return e==t+'';}if(!(c=s==U)){if(Z.call(e,'__wrapped__')||Z.call(t,'__wrapped__'))return l(e.__wrapped__||e,t.__wrapped__||t,n,r,o,a);if(s!=B)return!1;var s=!me.argsObject&&g(e)?Object:e.constructor,u=!me.argsObject&&g(t)?Object:t.constructor;if(s!=u&&!(f(s)&&s instanceof s&&f(u)&&u instanceof u))return!1}for(u=!o,o||(o=A.pop()||[]),a||(a=A.pop()||[]),s=o.length;s--;)if(o[s]==e)return a[s]==t;var d=0,p=!0;if(o.push(e),a.push(t),c){if(s=e.length,d=t.length,!(p=d==e.length)&&!r)return p;for(;d--;)if(c=s,u=t[d],r)for(;c--&&!(p=l(e[c],u,n,r,o,a)););else if(!(p=l(e[d],u,n,r,o,a)))break;return p}return ye(t,function(t,i,s){return Z.call(s,i)?(d++,p=Z.call(e,i)&&l(e[i],t,n,r,o,a)):void 0}),p&&!r&&ye(e,function(e,t,n){return Z.call(n,t)?p=-1<--d:void 0}),u&&(i(o),i(a)),p}function u(e,t,n,r,o,i){var a=1&t,s=2&t,c=4&t,l=8&t,d=16&t,m=32&t,g=e;if(!s&&!f(e))throw new TypeError;d&&!n.length&&(t&=-17,d=n=!1),m&&!r.length&&(t&=-33,m=r=!1);var h=e&&e.__bindData__;if(h)return!a||1&h[1]||(h[4]=o),!a&&1&h[1]&&(t|=8),!c||4&h[1]||(h[5]=i),d&&$.apply(h[2]||(h[2]=[]),n),m&&$.apply(h[3]||(h[3]=[]),r),h[1]|=t,u.apply(null,h);if(!a||s||c||m||!(me.fastBind||oe&&d))y=function(){var f=arguments,h=a?o:this;return(c||d||m)&&(f=ue.call(f),d&&ne.apply(f,n),m&&$.apply(f,r),c&&f.length<i)?(t|=16,u(e,l?t:-4&t,f,null,o,i)):(s&&(e=h[g]),this instanceof y?(h=p(e.prototype),f=e.apply(h,f),v(f)?f:h):e.apply(h,f))};else{if(d){var E=[o];$.apply(E,n)}var y=d?oe.apply(e,E):oe.call(e,o)}return ge(y,ue.call(arguments)),y}function d(){var e=r();e.h=O,e.b=e.c=e.g=e.i='',e.e='t',e.j=!0;for(var t,n=0;t=arguments[n];n++)for(var o in t)e[o]=t[o];n=e.a,e.d=/^[^,]+/.exec(n)[0],t=Function,n='return function('+n+'){',o='var n,t='+e.d+',E='+e.e+';if(!t)return E;'+e.i+';',e.b?(o+='var u=t.length;n=-1;if('+e.b+'){',me.unindexedChars&&(o+='if(s(t)){t=t.split(\'\')}'),o+='while(++n<u){'+e.g+';}}else{'):me.nonEnumArgs&&(o+='var u=t.length;n=-1;if(u&&p(t)){while(++n<u){n+=\'\';'+e.g+';}}else{'),me.enumPrototypes&&(o+='var G=typeof t==\'function\';'),me.enumErrorProps&&(o+='var F=t===k||t instanceof Error;');var i=[];if(me.enumPrototypes&&i.push('!(G&&n=="prototype")'),me.enumErrorProps&&i.push('!(F&&(n=="message"||n=="name"))'),e.j&&e.f)o+='var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];',i.length&&(o+='if('+i.join('&&')+'){'),o+=e.g+';',i.length&&(o+='}'),o+='}';else if(o+='for(n in t){',e.j&&i.push('m.call(t, n)'),i.length&&(o+='if('+i.join('&&')+'){'),o+=e.g+';',i.length&&(o+='}'),o+='}',me.nonEnumShadows){for(o+='if(t!==A){var i=t.constructor,r=t===(i&&i.prototype),f=t===J?I:t===k?j:L.call(t),x=y[f];',k=0;7>k;k++)o+='n=\''+e.h[k]+'\';if((!(r&&x[n])&&m.call(t,n))',e.j||(o+='||(!x[n]&&t[n]!==A[n])'),o+='){'+e.g+'}';o+='}'}return(e.b||me.nonEnumArgs)&&(o+='}'),o+=e.c+';return E',t=t('d,j,k,m,o,p,q,s,v,A,B,y,I,J,L',n+o+'}'),a(e),t(c,H,K,Z,R,g,fe,h,e.f,Y,z,pe,W,G,te)}function p(e){return v(e)?ie(e):{}}function m(){var e=(e=s.indexOf)===w?n:e;return e}function g(e){return!(!e||'object'!=typeof e)&&te.call(e)==_}function f(e){return'function'==typeof e}function v(e){return!(!e||!z[typeof e])}function h(e){return'string'==typeof e||te.call(e)==W}function E(e,t,n){var r=-1,o=m(),i=e?e.length:0,a=!1;return n=(0>n?ce(0,i+n):n)||0,fe(e)?a=-1<o(e,t,n):'number'==typeof i?a=-1<(h(e)?e.indexOf(t,n):o(e,t,n)):Ee(e,function(e){return++r<n?void 0:!(a=e===t)}),a}function y(e,t,n){var r=[];if(t=s.createCallback(t,n,3),fe(e)){n=-1;for(var o=e.length;++n<o;){var i=e[n];t(i,n,e)&&r.push(i)}}else Ee(e,function(e,n,o){t(e,n,o)&&r.push(e)});return r}function b(e,t,n){if(t&&void 0===n&&fe(e)){n=-1;for(var r=e.length;++n<r&&!1!==t(e[n],n,e););}else Ee(e,t,n);return e}function T(e,t,n){var r=-1,o=e?e.length:0,i=Array('number'==typeof o?o:0);if(t=s.createCallback(t,n,3),fe(e))for(;++r<o;)i[r]=t(e[r],r,e);else Ee(e,function(e,n,o){i[++r]=t(e,n,o)});return i}function S(e,t,n,r){var o=3>arguments.length;if(t=c(t,r,4),fe(e)){var i=-1,a=e.length;for(o&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e)}else Ee(e,function(e,r,i){n=o?(o=!1,e):t(n,e,r,i)});return n}function w(e,t,r){if('number'==typeof r){var o=e?e.length:0;r=0>r?ce(0,o+r):r||0}else if(r)return r=C(e,t),e[r]===t?r:-1;return n(e,t,r)}function C(e,t,n,r){var o=0,i=e?e.length:o;for(t=(n=n?s.createCallback(n,r,1):I)(t);o<i;)r=o+i>>>1,n(e[r])<t?o=r+1:i=r;return o}function x(e,t){return 2<arguments.length?u(e,17,ue.call(arguments,2),null,t):u(e,1,null,null,t)}function I(e){return e}var A=[],N=[],R={},M=40,D=/^function[ \n\r\t]+\w/,L=(L=/\bthis\b/)&&L.test(function(){return this})&&L,O='constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf'.split(' '),_='[object Arguments]',U='[object Array]',F='[object Boolean]',P='[object Date]',H='[object Error]',j='[object Number]',B='[object Object]',V='[object RegExp]',W='[object String]',z={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},q=z[typeof e]&&e||this,X=[],K=Error.prototype,Y=Object.prototype,G=String.prototype,J=RegExp('^'+(Y.valueOf+'').replace(/[.*+?^${}()|[\]\\]/g,'\\$&').replace(/valueOf|for [^\]]+/g,'.+?')+'$'),Q=Function.prototype.toString,Z=Y.hasOwnProperty,$=X.push,ee=Y.propertyIsEnumerable,te=Y.toString,ne=X.unshift,re=function(){try{var e={},t=J.test(t=Object.defineProperty)&&t,n=t(e,e,e)&&t}catch(e){}return n}(),oe=J.test(oe=te.bind)&&oe,ie=J.test(ie=Object.create)&&ie,ae=J.test(ae=Array.isArray)&&ae,se=J.test(se=Object.keys)&&se,ce=Math.max,le=Math.min,ue=X.slice,q=J.test(q.attachEvent),de=oe&&!/\n|true/.test(oe+q),pe={};pe[U]=pe[P]=pe[j]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},pe[F]=pe[W]={constructor:!0,toString:!0,valueOf:!0},pe[H]=pe['[object Function]']=pe[V]={constructor:!0,toString:!0},pe[B]={constructor:!0},function(){for(var e=O.length;e--;){var t,n=O[e];for(t in pe)Z.call(pe,t)&&!Z.call(pe[t],n)&&(pe[t][n]=!1)}}();var me=s.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},n=[];e.prototype={valueOf:1,y:1};for(var r in new e)n.push(r);for(r in arguments);me.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),me.argsClass=te.call(arguments)==_,me.enumErrorProps=ee.call(K,'message')||ee.call(K,'name'),me.enumPrototypes=ee.call(e,'prototype'),me.fastBind=oe&&!de,me.funcNames='string'==typeof Function.name,me.nonEnumArgs=0!=r,me.nonEnumShadows=!/valueOf/.test(n),me.spliceObjects=(X.splice.call(t,0,1),!t[0]),me.unindexedChars='xx'!='x'[0]+Object('x')[0]}(1),ie||(p=function(e){if(v(e)){o.prototype=e;var t=new o;o.prototype=null}return t||{}});var ge=re?function(e,t){var n=r();n.value=t,re(e,'__bindData__',n),a(n)}:o;me.argsClass||(g=function(e){return!(!e||'object'!=typeof e)&&Z.call(e,'callee')});var fe=ae||function(e){return!(!e||'object'!=typeof e)&&te.call(e)==U},ve=d({a:'z',e:'[]',i:'if(!(B[typeof z]))return E',g:'E.push(n)'}),he=se?function(e){return v(e)?me.enumPrototypes&&'function'==typeof e||me.nonEnumArgs&&e.length&&g(e)?ve(e):se(e):[]}:ve,q={i:'if(!B[typeof t])return E;'+(ae={a:'g,e,K',i:'e=e&&typeof K==\'undefined\'?e:d(e,K,3)',b:'typeof u==\'number\'',v:he,g:'if(e(t[n],n,g)===false)return E'}).i,b:!1},Ee=d(ae),ye=d(ae,q,{j:!1}),ae=d(ae,q);return f(/x/)&&(f=function(e){return'function'==typeof e&&'[object Function]'==te.call(e)}),s.bind=x,s.createCallback=function(e,t,n){var r=typeof e;if(null==e||'function'==r)return c(e,t,n);if('object'!=r)return function(t){return t[e]};var o=he(e),i=o[0],a=e[i];return 1!=o.length||a!==a||v(a)?function(t){for(var n=o.length,r=!1;n--&&(r=l(t[o[n]],e[o[n]],null,!0)););return r}:function(e){return e=e[i],a===e&&(0!==a||1/a==1/e)}},s.filter=y,s.forEach=b,s.forIn=ye,s.forOwn=ae,s.keys=he,s.map=T,s.pluck=T,s.collect=T,s.each=b,s.select=y,s.contains=E,s.identity=I,s.indexOf=w,s.isArguments=g,s.isArray=fe,s.isFunction=f,s.isNumber=function(e){return'number'==typeof e||te.call(e)==j},s.isObject=v,s.isString=h,s.isUndefined=function(e){return void 0===e},s.lastIndexOf=function(e,t,n){var r=e?e.length:0;for('number'==typeof n&&(r=(0>n?ce(0,r+n):le(n,r-1))+1);r--;)if(e[r]===t)return r;return-1},s.reduce=S,s.sortedIndex=C,s.foldl=S,s.include=E,s.inject=S,s.last=function(e,t,n){var r=0,o=e?e.length:0;if('number'!=typeof t&&null!=t){var i=o;for(t=s.createCallback(t,n,3);i--&&t(e[i],i,e);)r++}else if(null==(r=t)||n)return e?e[o-1]:void 0;for(t=ce(0,o-r),r=void 0,t||(t=0),void 0===r&&(r=e?e.length:0),n=-1,r=r-t||0,o=Array(0>r?0:r);++n<r;)o[n]=e[t+n];return o},s.VERSION='2.0.0',s}(this),j=new a,B={consoleTimingSupported:window.console&&window.console.time&&window.console.timeEnd&&window.console.timeStamp,hasNativeStartsWith:H.isFunction(String.prototype.startsWith),currentTimestamp:H.isFunction(Date.now)&&H.isNumber(Date.now())?Date.now:function(){return new Date().getTime()},isElement:function(e){return'hasAttribute'in e},isDOMElement:function(e){return'object'==typeof HTMLElement?e instanceof HTMLElement:e&&'object'==typeof e&&null!==e&&1===e.nodeType&&'string'==typeof e.nodeName},hasMutationObserver:function(){return'undefined'!=typeof MutationObserver||'undefined'!=typeof WebKitMutationObserver},isOldIE:function(){return!n.addEventListener},hasTouch:function(){return'ontouchstart'in window},isChromeDesktop:function(){var e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|Windows Phone|IEMobile|Opera Mini|Mobile|mobile|Tablet|CriOS/i.test(e),n=/Chrome/i.test(e);return!t&&n},getAttributeForElement:function(e,t){if(!e||!B.isElement(e))return null;var n;return e.hasAttribute(t.toLocaleLowerCase())?n=e.getAttribute(t.toLocaleLowerCase()):e.hasAttribute(t.toLocaleUpperCase())&&(n=e.getAttribute(t.toLocaleUpperCase())),n&&(n=B.trim(n)),n||null},getElementId:function(e){return e&&e.id?H.isString(e.id)?e.id:e.getAttribute('id'):null},isDuplicateElementId:function(e){try{return'querySelectorAll'in n&&n.querySelectorAll('[id=\''+e+'\']').length>1}catch(e){return!1}},getMouseEnterTarget:function(){return'onmouseenter'in n?n:'onmouseenter'in window?window:n.body},hasTimingAPI:function(){return!H.isUndefined(window.performance)&&!H.isUndefined(window.performance.timing)},startsWith:function(e,t){return!(!H.isString(e)||!H.isString(t))&&(B.hasNativeStartsWith?e.startsWith(t):e.slice(0,t.length)===t)},truncateStr:function(e,t,n){var r=e;return e&&e.length>t&&(r=e.substr(0,t),n&&(r=r.concat('...'))),r},getCoordinate:function(e){var t=e.changedTouches||e.touches,r=t&&t.length>0?t[0]:e,o=B.extractElementFromEvent(e);return B.isHybrid()||'HTML'===o.nodeName.toUpperCase()?new m(r.clientX,r.clientY):H.isUndefined(r.pageX)||H.isUndefined(r.pageY)?new m(e.clientX+n.body.scrollLeft+n.documentElement.scrollLeft,e.clientY+n.body.scrollTop+n.documentElement.scrollTop):new m(r.pageX,r.pageY)},getScrollTopLeft:function(){try{var e=null!==window.top&&window.top!==window.self?window.top:window;return{top:void 0!==e.pageYOffset?e.pageYOffset:(e.document.documentElement||e.document.body.parentNode||e.document.body).scrollTop,left:void 0!==e.pageXOffset?e.pageXOffset:(e.document.documentElement||e.document.body.parentNode||e.document.body).scrollLeft}}catch(e){return B.log('Failed getting scroll values: '+e.message,e),{top:0,left:0}}},getElementXYCoordinates:function(e){var t=e.getBoundingClientRect(),n=B.getScrollTopLeft();return new m(Math.round(t.left+n.left),Math.round(t.top+n.top))},isSameCoordinates:function(e,t){return e.x===t.x&&e.y===t.y},isCoordinatesDistLargerThan:function(e,t,n){return Math.abs(e.x-t.x)>n||Math.abs(e.y-t.y)>n},getCurrentScrollReach:function(){try{var e=null!==window.top&&window.top!==window.self?window.top:window;return(void 0!==e.pageYOffset?e.pageYOffset:(e.document.documentElement||e.document.body.parentNode||e.document.body).scrollTop)+(e.innerHeight||e.document.documentElement.clientHeight||e.document.body.clientHeight)}catch(e){return B.log('Failed getting scroll reach: '+e.message,e),0}},getWindowSize:function(){if(H.isNumber(window.innerWidth)&&H.isNumber(window.innerHeight)){try{if(null!==window.top&&window.top!==window.self)return B.validateSize(window.top.innerWidth,window.top.innerHeight)}catch(e){B.log('Failed querying the topmost window size for window (1) '+window.name+' - '+e.name+': '+e.message)}return B.validateSize(window.innerWidth,window.innerHeight)}if(!H.isUndefined(n.body)&&H.isNumber(n.body.offsetWidth)&&H.isNumber(n.body.offsetHeight)){try{if(null!==window.top&&window.top!==window.self)return K.validateSize(window.top.document.body.offsetWidth,window.top.document.body.offsetHeight)}catch(e){B.log('Failed querying the topmost window size for window (2): '+window.name+' - '+e.name+': '+e.message)}return B.validateSize(n.body.offsetWidth,n.body.offsetHeight)}return null},getScreenSize:function(){return B.validateSize(screen.width,screen.height)},validateSize:function(e,t){return H.isNumber(e)&&H.isNumber(t)?{width:e,height:t}:null},indexOfNode:function(e,t,n){for(var r=n||0;r<e.length;r++)if(e[r]===t)return r;return-1},getLocationUrlSplitByHash:function(){var e=window.location.href,t=e.indexOf('#');return-1===t?{url:e,withoutHash:e,hash:null}:{url:e,withoutHash:e.slice(0,t),hash:e.slice(t+1,e.length)}},getHashFromUrl:function(e){var t=e.indexOf('#');return-1===t?'':e.slice(t+1,e.length)},getReferrerUrlWithoutHash:function(){var e=window.document.referrer;if(!e||0===e.length)return null;var t=e.indexOf('#');return-1!==t?e.slice(0,t):e},encodeAsBase:function(e,t){return e.toString(t)},uuid:function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(e){var t=16*Math.random()|0;return('x'===e?t:3&t|8).toString(16)})},addEventHandler:function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent('on'+t,n)},removeEventHandler:function(e,t,n){H.isUndefined(e.removeEventListener)?H.isUndefined(e.detachEvent)||e.detachEvent('on'+t,n):e.removeEventListener(t,n,!0)},extractElementFromEvent:function(e){void 0===e&&(e=window.event);var t=e.target||e.srcElement;return null===t||void 0===t?null:3===t.nodeType?t.parentNode:t},eventDetectionTagNames:{select:'input',change:'input',submit:'form',reset:'form',error:'img',load:'img',unload:'img',abort:'img',readystatechange:'XMLHttpRequest'},isEventSupported:function(e){var t='on'+e;if(t in window||t in window.document)return!0;var r=n.createElement(B.eventDetectionTagNames[t]||'div'),o=t in r;return o||(r.setAttribute(t,'return;'),o=H.isFunction(r[t])),r=null,o||B.log(e+' is not supported.'),o},isConsoleSupported:!H.isUndefined(window.console)&&H.isFunction(window.console.log),getReason:function(e){return H.isString(e)?'('+e+')':'(not specified)'},hashcode:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t},trim:function(e){return'function'!=typeof String.prototype.trim?e.replace(/^\s+|\s+$/g,''):e.trim()},log:function(){if(!H.isUndefined(C.debugMode)&&C.debugMode){var e=Array.prototype.slice.call(arguments,0);if(e.unshift(B.currentTimestamp()),!0===Y.page.frame&&e.push(' (in frame '+Y.page.id+')'),B.isConsoleSupported);else if(!H.isUndefined(window.console.log))e.join(' ')}},trace:function(){C.traceMode&&B.log.apply(this,arguments)},time:function(e){C.timingMode&&B.consoleTimingSupported&&window.console.time(e)},timeEnd:function(e){C.timingMode&&B.consoleTimingSupported&&window.console.timeEnd(e)},timeStamp:function(e){C.timingMode&&B.consoleTimingSupported&&window.console.timeStamp(e)},isMaskedElement:function(e){var t=B.getElementId(e);return'password'===e.type||H.contains(C.maskList,t)||e.hasAttribute(w.maskingAttribute)},extractDomain:function(e){var t;return e?(t=e.indexOf('://')>-1?e.split('/')[2]:e.split('/')[0],t=t.split(':')[0]):null},hasOneOfClassNames:function(e,t){for(var n=' '+B.getClass(e)+' ',r=0;r<t.length;r++)if(n.indexOf(' '+t[r]+' ')>-1)return!0;return!1},getClass:function(e){return e.getAttribute&&e.getAttribute('class')||''},getClassList:function(e){var t=B.getClass(e);return t?t.split(' '):[]},hasClassName:function(e,t){return(' '+B.getClass(e)+' ').indexOf(' '+t+' ')>-1},getHybridType:function(){return'undefined'==typeof eyeViewHybridBridge?null:eyeViewHybridBridge.getHybridType()},isHybrid:function(){return'undefined'!=typeof eyeViewHybridBridge},isHybridAndroid:function(){return B.isHybrid()&&B.getHybridType()===eyeViewHybridBridge.HYBRID_ANDROID},isHybridIOS:function(){return B.isHybrid()&&B.getHybridType()===eyeViewHybridBridge.HYBRID_IOS},immutableSet:function(){for(var e={},t=0;t<arguments.length;t++)e[arguments[t]]=!0;return e},DOMElement2Str:function(e){return e instanceof CharacterData?e.textContent:e.outerHTML},currentTimeStamp:function(){return new Date().getTime()},isAttachedToDOM:function(e){for(;e;){if(e===n)return!0;e=e.parentNode}return!1},ensureProperty:function(e){for(var t=Array.prototype.slice.call(arguments,1),n=e,r=0;r<t.length;r++)n.hasOwnProperty(t[r])||(n[t[r]]={}),n=n[t[r]];return n},readCookie:function(e){var t,r,o=e+'=',i=n.cookie.split(';');for(t=0;t<i.length;t++)if(0===(r=B.trim(i[t])).indexOf(o))return r.substring(o.length,r.length);return null},shallowExtend:function(e,t){var n,r={};for(n in e)r[n]=e[n];for(n in t)r[n]=t[n];return r},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},bus:j},V=function(){function e(){this.readyState=XMLHttpRequest.UNSENT,this.status=r,this.xdr=new XDomainRequest,this.xdr.onprogress=function(){},this.xdr.ontimeout=function(){};var e=this;this.xdr.onload=function(){e.status=200,e.readyState=XMLHttpRequest.DONE,e.onreadystatechange&&e.onreadystatechange()},this.xdr.onerror=function(){e.status=400,e.readyState=XMLHttpRequest.DONE,e.onreadystatechange&&e.onreadystatechange()}}e.prototype.open=function(e,t){-1===t.indexOf('://')&&(t=location.protocol+'//'+location.hostname+(t.startsWith('/')?'':'/')+t),this.xdr.open(e,t),this.readyState=XMLHttpRequest.OPENED,this.onreadystatechange&&this.onreadystatechange()},e.prototype.send=function(e){this.xdr.send(e),this.readyState=XMLHttpRequest.LOADING,this.onreadystatechange&&this.onreadystatechange()},e.prototype.setRequestHeader=function(){};var t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject('Msxml2.XMLHTTP')},function(){return new ActiveXObject('Msxml3.XMLHTTP')},function(){return new ActiveXObject('Microsoft.XMLHTTP')}];void 0!==window.XDomainRequest&&/(msie 8\.0|msie 9\.0)/i.test(window.navigator.userAgent)&&t.unshift(function(){return new e});var n=null;return{createXMLHTTPObject:function(){if(n)return n();var e,r=!1;for(e=0;e<t.length;e++){try{r=t[e](),n=t[e]}catch(e){continue}break}return r}}}();!function(e){'use strict';var t='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',n=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(t),r=String.fromCharCode,o=function(e){var t=e.charCodeAt(0);return t<128?e:t<2048?r(192|t>>>6)+r(128|63&t):r(224|t>>>12&15)+r(128|t>>>6&63)+r(128|63&t)},i=function(e){return e.replace(/[^\x00-\x7F]/g,o)},a=function(e){var n=[0,2,1][e.length%3],r=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[t.charAt(r>>>18),t.charAt(r>>>12&63),n>=2?'=':t.charAt(r>>>6&63),n>=1?'=':t.charAt(63&r)].join('')},s=e.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,a)},c=function(e){return s(i(e))},l=function(e,t){return t?c(e).replace(/[+\/]/g,function(e){return'+'==e?'-':'_'}):c(e)},u=function(e){return l(e,!0)},d=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}/g,p=function(e){return r(e.length<3?(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1):(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2))},m=function(e){return e.replace(d,p)},g=function(e){var t=e.length,o=t%4,i=(t>0?n[e.charAt(0)]<<18:0)|(t>1?n[e.charAt(1)]<<12:0)|(t>2?n[e.charAt(2)]<<6:0)|(t>3?n[e.charAt(3)]:0),a=[r(i>>>16),r(i>>>8&255),r(255&i)];return a.length-=[0,0,2,1][o],a.join('')},f=e.atob||function(e){return e.replace(/[\s\S]{1,4}/g,g)},v=function(e){return m(f(e))},h=function(e){return v(e.replace(/[-_]/g,function(e){return'-'==e?'+':'/'}).replace(/[^A-Za-z0-9\+\/]/g,''))},E=function(e){for(var n,r='',o=0;o<e.length;o+=3)n=(252&e[o])>>2,r+=t.charAt(n),n=(3&e[o])<<4,o+1<e.length?(n|=(240&e[o+1])>>4,r+=t.charAt(n),n=(15&e[o+1])<<2,o+2<e.length?(n|=(192&e[o+2])>>6,r+=t.charAt(n),n=63&e[o+2],r+=t.charAt(n)):(r+=t.charAt(n),r+='=')):(r+=t.charAt(n),r+='==');return r};e.Base64={atob:f,btoa:s,fromBase64:h,toBase64:l,bytesToBase64:E,utob:i,encode:l,encodeURI:u,btou:m,decode:h}}(B),s.prototype.put=function(e,t){var n={key:e,value:t};if(this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit)return this.shift();this.size++},s.prototype.shift=function(){var e=this.head;return e&&(this.head.newer?(this.head=this.head.newer,this.head.older=r):this.head=r,e.newer=e.older=r,delete this._keymap[e.key]),e},s.prototype.get=function(e,t){var n=this._keymap[e];if(n!==r)return n===this.tail?t?n:n.value:(n.newer&&(n===this.head&&(this.head=n.newer),n.newer.older=n.older),n.older&&(n.older.newer=n.newer),n.newer=r,n.older=this.tail,this.tail&&(this.tail.newer=n),this.tail=n,t?n:n.value)},s.prototype.find=function(e){return this._keymap[e]},s.prototype.set=function(e,t){var n,r=this.get(e,!0);return r?(n=r.value,r.value=t):(n=this.put(e,t))&&(n=n.value),n},s.prototype.toString=function(){for(var e='',t=this.head;t;)e+=String(t.key)+':'+t.value,(t=t.newer)&&(e+=' < ');return e},w.dictionary={eventTypes:{change:0,document:2,mousedown:3,touchstart:4,touchend:5,focusout:6,blur:7,unload:9,submit:10,reset:11,mouseup:12,drag:13,scroll:14,popstate:15,keydown:16,keyup:17,keypress:18,timing:20,idle:21,ajaxRequest:22,formValidationError:23,hashchange:25,botDetection:26,mouseenter:27,navigation:28,mousemove:29,error:30,thirdparty:31,custom:32,hover:33,thirdpartymap:34,performance:35,resource:36,clsdebug:37,resize:38,webSocketOpen:50,webSocketClose:51,webSocketError:52,webSocketFrame:53,pageSnapshot:91,pageUpdate:92,resourceContent:93},elements:{DIV:0,SPAN:1,INPUT:2,FORM:3,SELECT:4,TEXTAREA:5,TABLE:6,TR:7,TD:8,IFRAME:9,TBODY:10,THEAD:11,LABEL:12},encodingTypes:{cd_number:0,cd_boolean:1,cd_string:2,cd_coordinate:3},performanceTimingEvents:{navigationStart:1,redirectStart:2,fetchStart:4,domainLookupStart:5,connectStart:7,secureConnectionStart:8,requestStart:10,responseStart:13,domLoading:15,domContentLoadedEventStart:17,domComplete:19,loadEventStart:20,loadEventEnd:21},encode:function(e,t){var n=t[e];return n!==r?n:e},encodeEventType:function(e){return w.dictionary.encode(e,w.dictionary.eventTypes)},encodeNodeName:function(e){return w.dictionary.encode(e,w.dictionary.elements)},encodeEncodingType:function(e){return w.dictionary.encode(e,w.dictionary.encodingTypes)},encodePerformanceTimingMeasurement:function(e){return w.dictionary.encode(e,w.dictionary.performanceTimingEvents)}};var W={urlHistory:[],limit:150,direction:{BACK:1,FORWARD:2},urlType:{FULL_URL:1,HASH_ONLY:2},updateUrlHistory:function(){var e=n.location.href,t=W.urlHistory.length;if(0===t)return W.urlHistory.push(e),!1;if(W.urlHistory[t-1]===e)return!1;if(t>=2&&W.urlHistory[t-2]===e){var r=W.urlHistory.pop(),o=W.urlType.HASH_ONLY,i=B.getHashFromUrl(window.location.href),a=B.getHashFromUrl(r);return W.reportNavigation(W.direction.BACK,o,a,i),!0}return t>=W.limit&&W.urlHistory.shift(),W.urlHistory.push(e),!1},reportNavigation:function(e,t,n,r){var o=Y.createEventObject('navigation',B.currentTimestamp(),null);o.value={direction:e,urlType:t,fromUrl:n,toUrl:r},o.shouldEncodeValue=!1,o.binding={valueEncoding:K.encodeNavigation},Y.saveEvent(o)},printHistory:function(){for(var e=0;e<W.urlHistory.length;e++);}},z={severity:{ERROR:0,WARN:1,INFO:2,DEBUG:3},types:{GENERAL_ERR:{code:100,count:0},INVALID_TIMING_ERR:{code:101,count:0},TOP_WINDOW_SIZE_ERR:{code:102,count:0},WINDOW_SIZE_NOT_VALID_ERR:{code:103,count:0},KEREN_ERR:{code:104,count:0}},currentDebugInfo:null,registerError:function(e,t){z.registerDebugInfo(z.severity.ERROR,e,t)},registerErrorAndLog:function(e,t){z.registerDebugInfoAndLog(z.severity.ERROR,e,t)},registerDebugInfoAndLog:function(e,t,n){z.registerDebugInfo(e,t,n),B.log(n)},registerDebugInfo:function(e,t,n){t.count++,null===z.currentDebugInfo&&(z.currentDebugInfo=new c(e,t.code,t.count,n))},getRegisteredDebugInfo:function(e){var t=z.currentDebugInfo;return null===t||H.isUndefined(t)?null:(e&&z.clearDebugInfo(),t)},clearDebugInfo:function(){z.currentDebugInfo=null},setRegisteredDebugInfoOnEvent:function(e){if(null===e.getDebugInfo()||H.isUndefined(e.getDebugInfo())){var t=z.getRegisteredDebugInfo(!0);null!==t&&void 0!==t&&e.setDebugInfo(t)}},setErrorOnEvent:function(e,t,n){z.setDebugInfoOnEvent(e,z.severity.ERROR,t,n)},setErrorOnEventAndLog:function(e,t,n,r){z.setDebugInfoOnEvent(e,z.severity.ERROR,t,n),r?B.log(n,r):B.log(n)},setWarnOnEvent:function(e,t,n){z.setDebugInfoOnEvent(e,z.severity.WARN,t,n)},setDebugInfoOnEvent:function(e,t,n,r){if(null===e||H.isUndefined(e))B.log('Failed setting debug on non-existing event');else{var o=new c(t,n.code,n.count,r);e.setDebugInfo(o)}}},q={specialChar:{tilda:'_clstil',asterisks:'_clsast',space:'_clsspc'},shouldEncode:w.encodeSelectors,getSelectorExpression:function(e,t,n){this.shouldEncode=void 0!==t?t:w.encodeSelectors,n=n||{useId:!0};var r=C.useIdSelectors&&n.useId;if(null===e||H.isUndefined(e)||!B.isElement(e))return w.encoding.rootSelector;if(e.name&&C.preferNamesInFormSelectors&&this.hasFormAncestor(e))return this.getElementWithAttribute(e,'name');if(r){var o=B.getElementId(e);if(o&&!B.isDuplicateElementId(o)&&q.checkAllowUseId(e,o))return this.getElementNameWithId(e,!0)}if(e.name&&C.useNameInFormSelectors&&this.hasFormAncestor(e))return this.getElementWithAttribute(e,'name');for(var i=[this.getElementNameWithClasses(e)],a=e,s=this.shouldEncode?'*':'>';a.parentNode&&!this.isRoot(a);)if(1===(a=a.parentNode).nodeType){var c=B.getElementId(a);if(c&&r&&!B.isDuplicateElementId(c)&&q.checkAllowUseId(a,c))return this.addToHeadIfFound(i,this.getElementNameWithId(a,!1)),i.join(s);var l=this.getElementNameWithClasses(a);if(this.addToHeadIfFound(i,l),a===parent)return i.join(s)}return i.join(s)},getElementNameWithClasses:function(e){if(this.isRoot(e))return this.shouldEncode?w.encoding.rootSelector:'BODY';var t=this.encodeNodeName(e.nodeName),n=this.getSiblingIndex(e);if(null!==n)return this.encodeElementNameAndSiblingIndex(t,n);if(w.useClassesInSelectors){var r=B.getClassList(e);if(r.length>0){for(var o=t,i=0;i<r.length;i++)o+='.'+r[i];return o}}return t},getSiblingIndex:function(e){if(!e.parentNode)return null;var t=e.parentNode.childNodes;if(t.length<2)return null;for(var n=e.nodeName,r=[],o=0;o<t.length;o+=1)t[o].nodeName===n&&r.push(t[o]);if(r.length<2)return null;for(var i=0;i<r.length;i+=1)if(r[i]===e)return i;return null},getElementNameWithId:function(e,t){if(this.isRoot(e))return null;var n=B.getElementId(e);return(n&&-1!==n.indexOf('~')||-1!==n.indexOf('*')||-1!==n.indexOf(' '))&&(n=this.replaceSpecialChars(n)),t?this.encodeNodeName(e.nodeName)+'#'+n:'#'+n},addToHeadIfFound:function(e,t){var n=typeof t;'string'!=n&&'number'!=n||e.unshift(t)},encodeElementNameAndSiblingIndex:function(e,t){var n=e;return this.shouldEncode||(n+=':eq'),n+'('+t+')'},encodeNodeName:function(e){return this.shouldEncode?w.dictionary.encodeNodeName(e):e},isRoot:function(e){var t=e.nodeName;return'HTML'===t||'BODY'===t},replaceSpecialChars:function(e){return e.replace(/~/g,this.specialChar.tilda).replace(/\*/g,this.specialChar.asterisks).replace(/ /g,this.specialChar.space)},hasFormAncestor:function(e){for(var t=e.parentNode;null!==t;){if('FORM'===t.nodeName)return!0;t=t.parentNode}return!1},getElementWithAttribute:function(e,t){var n='['+t+'='+e.getAttribute(t)+']';return-1===n.indexOf('~')&&-1===n.indexOf('*')&&-1===n.indexOf(' ')||(n=this.replaceSpecialChars(n)),this.encodeNodeName(e.nodeName)+n},checkAllowUseId:function(e,t){if(0===C.noIdSelectorsForClassNames.length&&0===C.noIdSelectorsForIDs.length&&0===C.noIdSelectorsForAttrs.length)return!0;var n,r=B.getClassList(e);for(n=0;n<C.noIdSelectorsForClassNames.length;n++)if(H.indexOf(r,C.noIdSelectorsForClassNames[n])>0)return!1;for(n=0;n<C.noIdSelectorsForAttrs.length;n++)if(e.hasAttribute(C.noIdSelectorsForAttrs[n]))return!1;for(n=0;n<C.noIdSelectorsForIDs.length;n++){var o=C.noIdSelectorsForIDs[n];if(o&&t.indexOf(o)>=0)return!1}return!0}},X={shouldListenToLoadResources:function(){return!(!C.reportAllResourcesLoad&&!C.reportExternalResources)||C.reportScriptURLContainList.length>0&&C.reportScriptKeyList.length>0||C.reportImageURLContainList.length>0&&C.reportImageKeyList.length>0},filterLoad:function(e){if(!e)return!0;var t=e.nodeName.toUpperCase();if('STYLE'===t)return!0;if(H.indexOf(C.ignoreReportResourcesByTagNames,t)>=0)return!0;if('IFRAME'===t&&e.src.indexOf('eyeviewevent')>=0)return B.log('filtering hybrid iOS loading iframe event: ',e.src),!0;if(C.reportAllResourcesLoad)return!1;var n=e.src||e.href;return(!C.reportExternalResources||!X.isExternalResource(n,e))&&('SCRIPT'===t&&C.reportScriptURLContainList.length>0?!X.isUrlToReport(n,C.reportScriptURLContainList):!('IMG'===t&&C.reportImageURLContainList.length>0)||!X.isUrlToReport(n,C.reportImageURLContainList))},interceptLoad:function(e){var t=e.element.nodeName;Y.addResource(t,e.value,e.timestamp).event=e;var n=e.element.src||e.element.href;if(!n)return!1;if(0===n.indexOf('data:'))return!1;var r=null;if('SCRIPT'===t&&C.reportScriptURLContainList.length>0?X.isUrlToReport(n,C.reportScriptURLContainList)&&(r=X.parseToKVMap(n,C.reportScriptKeyList)):'IMG'===t&&C.reportImageURLContainList.length>0&&X.isUrlToReport(n,C.reportImageURLContainList)&&(r=X.parseToKVMap(n,C.reportImageKeyList)),r){B.trace('intercepted thirdparty resource parameters map for url: '+n);var o={value:r};Y.saveThirdPartyMapEvent(o)}return!!C.reportAllResourcesLoad||!(!C.reportExternalResources||!X.isExternalResource(n,e.element))},isUrlToReport:function(e,t){if(void 0===e||null===e)return!1;var n=e.indexOf('?');if(-1===n)return!1;e=e.substr(0,n);for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1},parseToKVMap:function(e,t){for(var n,r,o={},i=e.substring(e.indexOf('?')+1).split('&'),a=!1,s=0;s<i.length;s++){var c=i[s],l=c.indexOf('=');try{if(n=decodeURIComponent(c.substr(0,l)),!H.contains(t,n))continue;r=decodeURIComponent(c.substr(l+1)),o[n]=r,a=!0}catch(e){B.log('Error in ResourceHandler: Failed parsing a key-value pair '+(n?'[key='+n+']':'')+' : '+c,e)}}return a?o:null},isExternalResource:function(e,t){if(!e)return!1;if(void 0!==t._cls_external_res)return t._cls_external_res;var n=window.location.hostname,r=B.extractDomain(e);return t._cls_external_res=r!==n,t._cls_external_res}},K={state:{currentlyEncodedPageEvent:null},compress:function(e){return B.pako.gzip(e)},encodePageDetails:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];return e.frame&&t(n,'t',e.frame?'f':'p'),t(n,'u',K.encodeHashCode(e.urlWithoutHash)),e.hash&&t(n,'h',B.Base64.encode(e.hash)),Y.state.lastSizes.window=K.captureWindowSize(),Y.state.lastSizes.screen=K.captureScreenSize(),t(n,'s',K.encodeResolution(Y.state.lastSizes.window)),t(n,'sc',K.encodeResolution(Y.state.lastSizes.screen)),e.referrerWithoutHash&&t(n,'r',K.encodeHashCode(e.referrerWithoutHash)),w.reportBase64URLs&&t(n,'ub',B.Base64.encode(e.url)),n.join('*')},encodePageSnapshotData:function(e){var t='h',n=beaconEncodingManager.encoder.encodeSnapshotHtml(e.html);return n.compressed?t='hh':n.plain&&(t='p'),['sn_'+e.seq,'r_'+B.Base64.encode(e.referrer),'c_'+B.Base64.encode(e.cookie),'ch_'+e.charset,t+'_'+n.encoded].join('*')},captureWindowSize:function(){if(H.isNumber(window.innerWidth)&&H.isNumber(window.innerHeight)){try{if(null!==window.top&&window.top!==window.self)return K.validateSize(window.top.innerWidth,window.top.innerHeight,'[top inner]')}catch(t){var e='Failed querying the topmost window size for window (1): '+window.name+' - '+t.name+': '+t.message;z.setErrorOnEventAndLog(K.state.currentlyEncodedPageEvent,z.types.TOP_WINDOW_SIZE_ERR,e,t)}return K.validateSize(window.innerWidth,window.innerHeight,'[inner]')}if(!H.isUndefined(n.body)&&H.isNumber(n.body.offsetWidth)&&H.isNumber(n.body.offsetHeight)){try{if(null!==window.top&&window.top!==window.self)return K.validateSize(window.top.document.body.offsetWidth,window.top.document.body.offsetHeight,'[top offset]')}catch(e){var t='Failed querying the topmost window size for window (2): '+window.name+' - '+e.name+': '+e.message;z.setErrorOnEventAndLog(K.state.currentlyEncodedPageEvent,z.types.TOP_WINDOW_SIZE_ERR,t,e)}return K.validateSize(n.body.offsetWidth,n.body.offsetHeight,'[offset]')}return null},captureScreenSize:function(){return K.validateSize(screen.width,screen.height,'[screen]')},validateSize:function(e,t,n){var r=H.isNumber(e)&&H.isNumber(t);return r||z.setErrorOnEvent(K.state.currentlyEncodedPageEvent,z.types.WINDOW_SIZE_NOT_VALID_ERR,'Non valid values for window size for '+n+': x='+e+' y='+t),r?{width:e,height:t}:null},encodeResize:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];return t(n,'ws',K.encodeResolution(e.window)),t(n,'sc',K.encodeResolution(e.screen)),n.join('*')},encodeResolution:function(e){return null!==e&&H.isNumber(e.width)&&H.isNumber(e.height)?e.width+'x'+e.height:'x'},encodeTimings:function(e){return H.reduce(e,function(e,t,n){var r='u_'+n+'*t_'+t.total;return H.isNumber(t.rendering)&&(r+='*r_'+t.rendering),H.isNumber(t.dns)&&(r+='*d_'+t.dns),H.isNumber(t.timeToFirstBuffer)&&(r+='*f_'+t.timeToFirstBuffer),H.isNumber(t.downloadTime)&&(r+='*w_'+t.downloadTime),H.isNumber(t.originalRenderTime)&&(r+='*o_'+t.originalRenderTime),H.isString(e)&&e.length>0?e+'**'+r:r},'')},encodePerformanceTimings:function(e){var t=e.perf.timing,n=e.perf.navigation,r=e.browserTime,o=function(e,t,n){H.isNumber(n)&&e.push(t+'_'+K.encodeNumber(n))},i=[];for(var a in t)void 0!==w.dictionary.performanceTimingEvents[a]&&o(i,w.dictionary.encodePerformanceTimingMeasurement(a),t[a]);return n&&H.isNumber(n.type)&&o(i,'nt',n.type),n&&H.isNumber(n.redirectCount)&&o(i,'rc',n.redirectCount),r&&o(i,'bt',r),i.join('*')},encodeAjaxRequest:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[],r=K.encodeHashCode(e.url),o=e.ajaxUrls.get(r);return H.isUndefined(o)&&(e.ajaxUrls.set(r,e.url),t(n,'u',B.Base64.encode(e.url))),t(n,'uh',r),e.duration&&t(n,'d',K.encodeNumber(e.duration)),e.status&&t(n,'s',K.encodeNumber(e.status)),e.statusText&&t(n,'st',B.Base64.encode(e.statusText)),n.join('*')},encodeResourceContent:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];if(!H.isUndefined(e.getUrl()))return t(n,'u',B.Base64.encode(e.getUrl())),e.getContentType()&&e.getContentType().length>0&&t(n,'t',B.Base64.encode(e.getContentType())),e.getContent()&&e.getContent().length>0&&(t(n,'dd',B.Base64.bytesToBase64(e.getContent())),e.setStatus(e.Status.SENT)),e.getError()&&e.getError().length>0&&(t(n,'er',B.Base64.encode(e.getError())),e.setStatus(e.Status.SENTERROR)),n.join('*')},encodeWebSocketFrame:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];return t(n,'i',B.Base64.encode(e.id)),t(n,'d',K.encodeBoolean(e.direction)),e.isBinary()?t(n,'bp',B.Base64.bytesToBase64(new Uint8Array(e.payload))):t(n,'tp',B.Base64.encode(e.payload)),n.join('*')},encodeWebSocketSimpleEvent:function(e){return'i_'+B.Base64.encode(e.id)},encodeWebSocketCloseEvent:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];t(n,'i',B.Base64.encode(e.id));var r=e.event;return t(n,'c',K.encodeNumber(r.code)),t(n,'r',B.Base64.encode(r.reason)),t(n,'w',K.encodeBoolean(r.wasClean)),n.join('*')},encodeCustomEvent:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];return t(n,'n',B.Base64.encode(e.name)),t(n,'v',B.Base64.encode(e.val)),n.join('*')},encodeNavigation:function(e){var t=function(e,t,n){H.isString(n)&&e.push(t+'_'+n)},n=[];return e.direction&&t(n,'d',K.encodeNumber(e.direction)),e.urlType&&t(n,'u',K.encodeNumber(e.urlType)),H.isUndefined(e.fromUrl)||t(n,'f',B.Base64.encode(e.fromUrl)),H.isUndefined(e.toUrl)||t(n,'t',B.Base64.encode(e.toUrl)),n.join('*')},encodeKeyEvent:function(e){var t='';return e.unicode&&(t+=e.unicode),H.isUndefined(e.content)||(t+='_'+B.Base64.encode(e.content)),t},encodeClickDetails:function(e){return K.encodeCoordinate(e.start)+'*'+K.encodeCoordinate(e.end)+'*'+K.encodeNumber(e.duration)},encodeMouseMove:function(e){C.mmDebug&&B.log('encoding coordArr['+e.length+']:'+JSON.stringify(e));for(var t=[],n=0;n<e.length;n++){var r=e[n];!function(e,t,n,r){r=r||0;var o=C.mmRecordTimes?'_'+K.encodeNumber(r):'',i=Math.round(t),a=Math.round(n);e.push(K.encodeNumber(i)+'_'+K.encodeNumber(a)+o)}(t,r.x,r.y,r.t)}return t.join('*')},encodeHoverEvent:function(e){for(var t=[],n=[],r=e.length-1;r>=0;r--){var o=e[r];if(n.indexOf(o)>=0)C.mhDebug&&B.log('encode hover skipping duplicate: ',o);else{var i=q.getSelectorExpression(o);if(t.push(i),n.push(o),n.length>=C.mhMaxListSize)break;C.mhDebug&&B.log('encoding hover selector: '+i,o)}}var a=t.join(' ');return C.mhDebug&&B.log('encoding total of ['+t.length+'] hovers: '+a),a},encodeKVMap:function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];!function(e,t,n){H.isString(r)&&e.push(B.Base64.encode(t)+'_'+B.Base64.encode(n))}(t,n,r)}return t.join('*')},encodeNumber:function(e){if(H.isNumber(e))return B.encodeAsBase(e,w.encoding.numberBase);B.log('Trying to encode a non-number '+e)},encodeBoolean:function(e){return e?'1':'0'},encodeCoordinate:function(e){if(H.isNumber(e.x)&&H.isNumber(e.y)){var t=Math.round(e.x),n=Math.round(e.y);return K.encodeNumber(t)+'_'+K.encodeNumber(n)}B.log('Trying to encode coordinate with non-numbers x,y : ('+e.x+','+e.y+')')},encodeCoordinate64:function(e){return B.Base64.encode(K.encodeCoordinate(e))},encodeString:function(e){return B.Base64.encode(e)},encodeHashCode:function(e){if(H.isString(e)){var t=B.hashcode(e);return K.encodeNumber(t)}B.log('Trying to encode hashCode of a non-string '+e)},encodeAndConcatenateEventsForReportCookie:function(e,t){return H.reduce(e,function(e,t){var n=K.encodeEventAsString(t);return H.isString(e)&&e.length>0?e+w.encoding.delimiters.events+n:n},t)}};eventEncodingUtils={compress:function(e){return B.pako.gzip(e)},encodeTimestamp:function(e){var t=e.timestamp;return H.isNumber(t)||(B.log('Missing event timestamp',e),t=B.currentTimestamp()),K.encodeNumber(t)},encodeEventType:function(e){return w.encodeEventTypes?w.dictionary.encodeEventType(e):e},encodeExtraInfo:function(e){var t=e.extraInfo;if(H.isUndefined(t))return'';for(var n=[],r=f.prototype.extraInfoAttrs,o=0;o<r.length;o++){var i=r[o],a=t[i.name];H.isUndefined(a)||function(e,t,n,r){H.isString(n)&&e.push(t+'.'+r+'_'+n)}(n,i.encodeName,i.encodeFunc(a),i.encodeCode)}return n.join('*')},encodeDebugInfo:function(e){var t=e.debugInfo;if(H.isUndefined(t))return'-';var n=function(e,t,n){H.isUndefined(n)||e.push(t+'_'+n)},r=[];return n(r,'s',t.severity),n(r,'c',t.code),n(r,'i',t.count),t.msg&&t.count<=3&&n(r,'m',K.encodeString(t.msg)),r.join('*')}},beaconEncodingManager=function(e){var t;return t='json'===e.reportEncoding?new u(H,w,B,eventEncodingUtils,{reportDebugInfo:e.reportDebugInfo,compress:e.reportCompress,domCompress:e.domCompress}):new l(H,w,B,eventEncodingUtils,{reportDebugInfo:e.reportDebugInfo,domCompress:e.domCompress}),{encoder:t}}(C);var Y={env:w,config:C,utils:B,_:H,page:{timing:{}},bindings:{registered:[],unsupportedEventTypes:[]},plugins:{},reports:{events:[],resources:[]},state:{loaded:!1,clickStart:{},scrolling:{},unloading:!1,maxScrollReach:0,typableElementsLRUMap:new s(20),lastFocusData:{},mouseEnterReported:!1,hover:{hoverStartTimestamp:0,hoverElementList:[]},clsDebugCounter:0,lastSizes:{window:null,screen:null}},touchDetected:!1,ajaxUrls:new s(20),history:W,debugInfoHandler:z,initialize:function(){if(B.log('Initializing Detector... ('+w.setup+' setup)'),w.disabled)B.log('initialization cancelled: recording is DISABLED.');else{try{if(void 0!==M){var e=N.validate(M,C);if(e.errors.length>0)return;B.log('configuration fields validation report:'+e)}else B.log('Warning: configuration scheme not set, skipping configuration validation.')}catch(e){return}try{Y.setClientCookies(),Y.checkSupportModeSession(),Y.initializePageDetails(),W.updateUrlHistory(),Y.registerPlugins(),void 0!==Y.plugins.domMutationTracker&&domMutationTracker.isSemiDomActivated()&&Y.addDomReadyEventHandler(),Y.updateScrollReach(),Y.saveDocumentLoadEvent(B.currentTimestamp()),B.log('Extracted page details for '+Y.page.id+' at '+Y.page.urlWithoutHash),Y.registerPreLoadEvents(),C.SCIntegration&&j.on('3rdpartymap:scReport',Y.saveThirdPartyMapEvent),j.emit('init:preloaded');var t=window.document.readyState;B.log('readyState on initialization: '+t),!n.body||'complete'!==t&&'interactive'!==t?B.addEventHandler(window,'load',Y.onLoad,!1):Y.onLoad(),C.suppressMouseMovesDebug&&!C.mmDebug&&B.log('Suppressing \'mousemove\' events debug messages.')}catch(e){B.log('ERROR: while initializing detector. Exception: ',e.stack?e.stack:e.message),Y.saveClsDebugErrorEvent('initialize',e)}}},onLoad:function(){B.log('Post loading initialization... (readyState = '+window.document.readyState+')');var e=B.currentTimestamp();Y.state.loaded||(B.time('onLoadInitialization'),Y.documentEvent&&n.title.length>0&&(void 0===Y.page.title||0===Y.page.title.length)&&(Y.page.title=Y.getPageTitle(),Y.documentEvent.setExtraInfo(f.prototype.VISUAL_NAME,Y.page.title)),C.botDetection&&!B.hasTouch()&&Q.init(),Y.page.loadTimestamp=e,Y.resolvePageLoadTime(Y.page),C.reportValidationErrors&&j.on('jquery:validationError',Y.saveValidationError),Y.state.loaded=!0,j.emit('init:loaded'),Y.registerPostLoadEvents(),j.emit('init:post_binding'),B.timeEnd('onLoadInitialization'))},registerPlugins:function(){H.forOwn(Y.plugins,function(e,t){e.initialize(j)&&B.log('Registered plugin: '+t)})},registerPreLoadEvents:function(){var e=[{type:'beforeunload',interception:Y.interceptUnload,target:window,logicalName:'unload'},{type:'hashchange',valueExtraction:Y.extractLocationHash,target:window,interception:Y.interceptHashchange},{type:'resize',valueEncoding:K.encodeResize,filter:Y.filterResize,interception:Y.interceptResize,target:window},{type:Y.getChangeEventType(),valueExtraction:Y.extractElementValue,interception:Y.interceptFocusLost,filter:Y.filterNonChangableEventsElements,logicalName:'change',target:n},{type:Y.page.eventTypes.clickStart,interception:Y.interceptClickStart,target:n},{type:Y.page.eventTypes.clickEnd,interception:Y.interceptClickEnd,valueEncoding:K.encodeClickDetails,target:n},{type:'reset',target:n},{type:'submit',valueExtraction:Y.extractElementSource,valueEncoding:K.encodeHashCode,target:n},{type:Y.getFocusInEventType(),valueExtraction:Y.extractElementValue,interception:Y.interceptFocusIn,filter:Y.filterNonTypableElements,target:n}];'blur'!==Y.getChangeEventType()&&e.push({preload:!0,type:'blur',valueExtraction:Y.extractElementValue,interception:Y.interceptBlur,filter:Y.filterNonTypableElements,logicalName:'change',target:n}),X.shouldListenToLoadResources()&&e.push({type:'load',valueExtraction:Y.extractElementSource,filter:X.filterLoad,interception:X.interceptLoad,target:n,logicalName:'resource'}),C.recordMouseMoves&&e.push({type:'mousemove',valueExtraction:Y.extractMouseMoveValue,valueEncoding:K.encodeMouseMove,encodeValue:!1,interception:Y.interceptMouseMove,dependent:!0,dontSendElement:!0,target:n}),C.recordHovers&&e.push({type:'mouseover',encodeValue:!1,filter:Y.filterHovers,interception:Y.interceptMouseOver,valueEncoding:K.encodeHoverEvent,target:n}),C.recordScrolls&&e.push({type:'scroll',valueExtraction:Y.extractScrollValue,valueEncoding:K.encodeCoordinate,filter:Y.filterScrollElements,interception:Y.interceptScroll,dependent:C.dependentScroll,target:n}),C.recordErrors&&e.push({type:'error',valueExtraction:Y.extractErrorValue,interception:Y.interceptError,target:window}),C.recordConsoleErrors&&h({error:Y.onConsoleError});var t=B.getMouseEnterTarget();t!==n&&t!==window||e.push({type:'mouseenter',interception:Y.interceptMouseEnter,target:t}),Y.shouldListenToKeyEvents()&&(e.push({type:'keydown',interception:Y.interceptKeyboard,valueEncoding:K.encodeKeyEvent,dependent:!0,target:n}),e.push({type:'keypress',interception:Y.interceptKeyboard,valueEncoding:K.encodeKeyEvent,dependent:!0,target:n})),C.recordWebSocket&&(j.on('websocket:open',Y.eventSaver('webSocketOpen',K.encodeWebSocketSimpleEvent)),j.on('websocket:error',Y.eventSaver('webSocketError',K.encodeWebSocketSimpleEvent)),j.on('websocket:close',Y.eventSaver('webSocketClose',K.encodeWebSocketCloseEvent)),j.on('websocket:frame',Y.saveWebSocketFrame)),C.domRecordEnabled&&(j.on('pageSnapshot:save',Y.savePageSnapshotEvent),j.on('pageUpdate',Y.savePageUpdate)),Y.page.hasTimingAPI&&!C.recordAjaxCallsAnyway||(j.on('ajax:load',Y.recordAjaxResource),j.on('ajax:error',Y.recordAjaxResource)),C.recordAjaxRequest&&j.on('ajax:loadend',Y.saveAjaxRequestEvent),Y.bindPageEvents(e)},registerPostLoadEvents:function(){var e=[];Y.state.mouseEnterReported||B.getMouseEnterTarget()!==n.body||e.push({type:'mouseenter',interception:Y.interceptMouseEnter,target:n.body}),e.length>0&&Y.bindPageEvents(e)},bindPageEvents:function(e){B.time('bindPageEvents'),H.forEach(e,function(e){Y.registerEventBinding(e)}),B.log('Bound event types ('+Y.bindings.registered.length+'): '+H.pluck(Y.bindings.registered,'type')+(Y.bindings.unsupportedEventTypes.length?' Unsupported event types: ['+Y.bindings.unsupportedEventTypes.join(', ')+'].':'')),B.timeEnd('bindPageEvents')},registerEventBinding:function(e){var t=e.target||window.document.body;if(H.isUndefined(t)||null==t)B.log('Couldn\'t register \''+e.type+'\' handler on a non-existing element.',e);else try{Y.handleElementsEvents(t,e)}catch(t){B.log('Failed binding \''+e.type+'\'. Error: '+t.message,t),window.console}},handleElementsEvents:function(e,t){var n=t.type;if(H.contains(w.eventTypes,n))if(B.isEventSupported(n)){var r=Y.createHandlerForResolvingAndReportingElements(t);B.addEventHandler(e,n,r,!0),Y.bindings.registered.push({type:n,el:e,handler:r})}else Y.bindings.unsupportedEventTypes.push(n)},createHandlerForResolvingAndReportingElements:function(e){return function(t){if(Y.handleDOMEvent(t,e),'beforeunload'!==t.type)return!0}},handleDOMEvent:function(e,t){try{if(e=e||window.event,!H.isUndefined(e._cls_handled)&&!0===e._cls_handled)return void B.log('WARN: handler already handled this event. skipping..',e);e._cls_handled=!0,B.time('handleDOMEvent_'+e.type);var n=B.extractElementFromEvent(e),r=B.getElementId(n);C.ignorableElementIds&&H.contains(C.ignorableElementIds,r)||Y.handleEvent(e,n,t),B.timeEnd('handleDOMEvent_'+e.type)}catch(t){B.log('ERROR: while handling '+e.type+' DOM event ',e,' Exception: ',t.stack?t.stack:t.message),Y.saveClsDebugErrorEvent('handleDOMEvent',t,'event type='+e.type)}},handleEvent:function(e,t,n){if(!H.isFunction(n.filter)||!n.filter(t,e)){var r=B.currentTimestamp(),o=e.type;B.time('handleEvent_'+o);var i=Y.createEventObject(o,r,t);i.domEvent=e;var a=!H.isUndefined(n.dontSendElement)&&!0===n.dontSendElement;i.selectorExpression=a?w.encoding.rootSelector:q.getSelectorExpression(t)||w.encoding.rootSelector,i.binding=n,H.isUndefined(n.encodeValue)||!1!==n.encodeValue||(i.shouldEncodeValue=!1),H.isUndefined(n.dependent)||!0!==n.dependent||(i.dependent=!0),Y.extractValue(i,n),Y.extractExternalId(i,t),Y.interceptReport(i,n),C.reportVisualNames&&i.report&&!a&&Y.extractVisualName(i,t),Y.saveEvent(i),j.emit('event:'+i.type,i),B.timeEnd('handleEvent'+o)}},createEventObject:function(e,t,n){return new f(e,t,n,Y.page.id)},onDomReady:function(){n.addEventListener?n.removeEventListener('DOMContentLoaded',Y.onDomReady,!1):n.detachEvent('onreadystatechange',Y.onDomReady),j.emit('init:domready')},addDomReadyEventHandler:function(){'complete'!==n.readyState&&(n.addEventListener?window.addEventListener('DOMContentLoaded',Y.onDomReady,!1):n.attachEvent('onreadystatechange',Y.onDomReady))},extractValue:function(e,t){try{if(!H.isUndefined(t.valueExtraction)){var n=t.valueExtraction(e.domEvent,e.element);H.isUndefined(n)||null==n||(e.value=n)}}catch(t){B.log('Failed extracting value for event '+e.type+' - '+t.name+': '+t.message,t),'clsdebug'!==e.type&&Y.saveClsDebugErrorEvent('extractValue',t,'event type='+e.type)}},extractExternalId:function(e,t){if(t&&B.isElement(t)&&!H.isUndefined(C.externalIdAttr)&&H.isString(C.externalIdAttr)&&C.externalIdAttr.length>0){var n=B.getAttributeForElement(t,C.externalIdAttr);null!==n&&n.length>0&&e.setExtraInfo(f.prototype.EXTERNAL_ID,n)}},interceptReport:function(e,t){if(!H.isUndefined(t.interception))try{e.report=t.interception(e)}catch(t){B.log('Failed intercepting '+e.type+' event: '+t.message,t,e),'clsdebug'!==e.type&&Y.saveClsDebugErrorEvent('interceptReport',t,'event type='+e.type)}},addEvent:function(e){Y.config.debugMode&&Y.reports.events.push(e)},getFocusInEventType:function(){return B.isOldIE()?'focusin':'focus'},getChangeEventType:function(){return B.isOldIE()?'onfocusout'in n?'focusout':'blur':'change'},startFocusTiming:function(e){var t=B.currentTimestamp(),n=Y.state.lastFocusData.startTime;Y.state.lastFocusData={element:e,startTime:t,prevFocusStartTime:n}},endFocusTiming:function(e){if(Y.state.lastFocusData.element===e){var t=B.currentTimestamp();Y.state.lastFocusData.focusTime=t-Y.state.lastFocusData.startTime}else B.trace('Cannot measure focus time because of element mismatch. ')},filterNonTypableElements:function(e,t){return null===e||(Y.isChangebleElement(e)&&('focus'===t.type||'focusin'===t.type?Y.startFocusTiming(e):'blur'===t.type&&Y.endFocusTiming(e)),!Y.isTypableElement(e))},filterNonChangableEventsElements:function(e,t){return null===e||null===t||(Y.isChangebleElement(e)&&Y.endFocusTiming(e),'change'!==t.type&&!Y.isChangebleElement(e))},interceptFocusIn:function(e){return Y.checkTypedContentHasChangedAndUpdate(e),!1},interceptFocusLost:function(e){return null!==e&&null!==e.element&&(Y.state.lastFocusData.focusTime&&e.setExtraInfo(e.FOCUS_TIME_ATTR,Y.state.lastFocusData.focusTime),!!Y.isSelectableElement(e.element)||Y.checkTypedContentHasChangedAndUpdate(e))},interceptBlur:function(e){return Y.state.lastFocusData.focusTime&&e.setExtraInfo(e.FOCUS_TIME_ATTR,Y.state.lastFocusData.focusTime),Y.checkTypedContentHasChangedAndUpdate(e)},checkTypedContentHasChangedAndUpdate:function(e){var t='focus'===e.type||'focusin'===e.type,n='blur'===e.type||'focusout'===e.type,r=e.selectorExpression,o=e.value;if(null===o||H.isUndefined(o))return!1;var i={text:o,markAutoComplete:!1},a=Y.state.typableElementsLRUMap.set(r,i),s=H.isUndefined(a);if(t&&!s&&a.text!==o&&o.toLocaleLowerCase().indexOf(a.text.toLocaleLowerCase())>=0&&(i.markAutoComplete=!0),n&&!s&&a.markAutoComplete){var c=Y.state.lastFocusData.prevFocusStartTime;if(!H.isUndefined(c)&&H.isNumber(c)&&Y.state.lastFocusData.element===e.element){var l=B.currentTimestamp()-c;e.setExtraInfo(e.FOCUS_TIME_ATTR,l)}else B.log('Unable to compute total auto-complete time'),e.setExtraInfo(e.FOCUS_TIME_ATTR,-1);return e.setExtraInfo(e.AUTO_COMPLETE_ATTR,!0),!0}return s||a.text!==o},isMouseEvent:function(e){return'mousedown'===e||'mouseup'===e},isTouchEvent:function(e){return'touchstart'===e||'touchend'===e||'touchmove'===e},interceptMouseEnter:function(e){if(Y.state.mouseEnterReported)return!1;var t=B.getCoordinate(e.domEvent);return e.setExtraInfo(f.prototype.COORDINATE_ATTR,t),Y.removeEventBinding('mouseenter'),Y.state.mouseEnterReported=!0,Y.page.hasTouch&&!Y.touchDetected&&B.isChromeDesktop()&&(Y.switchTouchToMouse(),Y.page.hasTouch=!1),!0},switchTouchToMouse:function(){B.log('Mouse Detected. Switch touch event to mouse events'),Y.removeEventBinding('touchstart'),B.isHybridAndroid()?Y.removeEventBinding('touchmove'):Y.removeEventBinding('touchend');var e=[{type:'mousedown',interception:Y.interceptClickStart,target:n},{type:'mouseup',interception:Y.interceptClickEnd,valueEncoding:K.encodeClickDetails,target:n}];Y.bindPageEvents(e)},filterHovers:function(e,t){try{if('undefined'==typeof jQuery||H.isUndefined(jQuery)||H.isUndefined(jQuery._data))return!0;for(var r=e,o=1,i=H.isNumber(C.mhDeepLevel)?C.mhDeepLevel:1;null!==r&&r!==n.body&&o<=i;){var a=jQuery._data(r,'events');if(a&&a.mouseover&&a.mouseover.length>0)return C.mhDebug&&B.log('++ Hover adding element(level-'+o+') '+(r.id?r.id:''),r),Y.addHoverElement(r),!0;o++,r=r.parentElement}}catch(t){B.log('Exception while extracting hover information for element : ',e,t.message,t),Y.saveClsDebugErrorEvent('filterHovers',t,'element='+(e?e.nodeName:'null'))}return!0},addHoverElement:function(e){Y.state.hover.hoverElementList.length<C.mhMaxInMemeoryHovers?(Y.state.hover.hoverElementList.push(e),Y.state.hover.hoverStartTimestamp=B.currentTimestamp()):B.log('warn: exceed size of hover elements (>100). skipping..')},cleanHoverElements:function(){C.mhDebug&&B.log('Hover cleaning'),Y.state.hover.hoverElementList=[],Y.state.hover.hoverStartTimestamp=0},filterResize:function(){return B.isOldIE()},interceptResize:function(e){var t=B.getWindowSize(),n=B.getScreenSize(),r=!1;return null===t||null===Y.state.lastSizes.window||Y.state.lastSizes.window.width===t.width&&Y.state.lastSizes.window.height===t.height||(Y.state.lastSizes.window=t,r=!0),null===n||null===Y.state.lastSizes.screen||Y.state.lastSizes.screen.width===n.width&&Y.state.lastSizes.screen.height===n.height||(Y.state.lastSizes.screen=n,r=!0),e.value=Y.state.lastSizes,r},interceptMouseOver:function(e){return!1},interceptClickStart:function(e){if(Q.isActive()&&Y.isMouseEvent(e.type)&&Q.notifyMouseAction(e.domEvent),Y.isTouchEvent(e.type)&&(Y.touchDetected=!0),C.recordHovers&&Y.saveHoverEvent(),Y.state.clickStart=Y.createClickDetailsObject(e),e.setExtraInfo(f.prototype.COORDINATE_ATTR,Y.state.clickStart),!H.isUndefined(e.element)){var t=B.getElementXYCoordinates(e.element);e.setExtraInfo(f.prototype.SYNC_COORDINATE,t)}return B.isHybrid()&&e.addHybridActionDataItem('start',{x:Y.state.clickStart.x,y:Y.state.clickStart.y}),!0},interceptClickEnd:function(e){Q.isActive()&&Y.isMouseEvent(e.type)&&Q.notifyMouseAction(e.domEvent);var t={start:Y.state.clickStart,end:Y.createClickDetailsObject(e)};if(!(H.isNumber(t.start.x)&&H.isNumber(t.start.y)))return B.log('Dragging event with no captured click start.'),!1;var n=Math.abs(t.end.x-t.start.x)>C.minDragPixels||Math.abs(t.end.y-t.start.y)>C.minDragPixels;if(n){e.type='drag',t.duration=t.start.timestamp?e.timestamp-t.start.timestamp:-1,e.value=t;var r=B.getElementXYCoordinates(t.start.elementObj);e.setExtraInfo(f.prototype.SYNC_COORDINATE,r),B.isHybrid()&&(e.addHybridActionDataItem('start',{x:t.start.x,y:t.start.y}),e.addHybridActionDataItem('end',{x:t.end.x,y:t.end.y}))}return Y.state.clickStart={},n},interceptError:function(e){return e.value&&e.value.length>0},interceptHashchange:function(e){return W.updateUrlHistory(),!0},interceptUnload:function(e){B.time('unload'),B.log('Unloading...'),Y.state.unloading=!0;var t=B.currentTimestamp();Y.page.hasTimingAPI||J.set(w.cookies.referrer,K.encodeNumber(t)+'_'+B.Base64.encode(Y.page.urlWithoutHash));var n=t-Y.page.initializationTimestamp;return e.setExtraInfo(e.FOCUS_TIME_ATTR,n),e.setExtraInfo(e.SCROLL_REACH,Math.round(Y.state.maxScrollReach)),B.timeEnd('unload'),!0},updateScrollReach:function(){Y.state.maxScrollReach=Math.max(Y.state.maxScrollReach,B.getCurrentScrollReach())},interceptScroll:function(e){return'#document'===e.element.nodeName&&Y.updateScrollReach(),!0},filterScrollElements:function(e,t){return!(null!=e&&'MARQUEE'!==e.nodeName)},interceptMouseMove:function(e){return e.lastSingleMoveTimestamp=e.timestamp,e.setExtraInfo(e.FOCUS_TIME_ATTR,0),!0},createClickDetailsObject:function(e){var t=B.getCoordinate(e.domEvent);return t.elementObj=e.element,t.el=e.selectorExpression,t.timestamp=e.timestamp,t},shouldListenToKeyEvents:function(){return C.recordEnterForInputs||Y.recordAutoCompleteRelatedChars()},recordAutoCompleteRelatedChars:function(){return void 0===Y.acCharsSupport&&(Y.acCharsSupport=C.recordTypingAll||C.supportNativeAutoComplete||C.recordTypingForAttrs&&C.recordTypingForAttrs.length>0||C.recordTypingForClasses&&C.recordTypingForClasses.length>0||C.recordTypingForIDs&&C.recordTypingForIDs.length>0),Y.acCharsSupport},resolveKeyData:function(e){var t=e.domEvent,n=e.element.value,r=e.element,o=t.keyCode||t.charCode;e.value={unicode:o};var i=B.isMaskedElement(r);return'keypress'===e.type?13!==o&&8!==o&&'0'!==t.charCode&&(i?(e.value={unicode:42},!0):(H.isUndefined(n)||null===n||(e.value.content=n+String.fromCharCode(o)),!0)):'keydown'===e.type&&(38===o||40===o||13===o?(i||(e.value.content=e.element.value),!0):8===o&&!H.isUndefined(n)&&null!==n&&!i&&(e.value.content=n.length>0?n.substring(0,n.length-1):'',!0))},interceptKeyboard:function(e){var t=e.element;if(!(t&&('INPUT'===t.nodeName||'BUTTON'===t.nodeName)))return!1;var n=13===(e.domEvent.keyCode||e.domEvent.charCode);if(e.shouldEncodeValue=!1,n&&C.recordEnterForInputs)return Y.resolveKeyData(e);if(C.supportNativeAutoComplete&&(t.hasAttribute('autocomplete')||t.hasAttribute('aria-autocomplete')&&'none'!==t.getAttribute('aria-autocomplete')||t.hasAttribute('class')&&H.contains(t.getAttribute('class'),'autocomplete')))return Y.resolveKeyData(e);if(C.recordTypingAll)return Y.resolveKeyData(e);var r;if(C.recordTypingForAttrs&&C.recordTypingForAttrs.length>0)for(r=0;r<C.recordTypingForAttrs.length;r++)if(t.hasAttribute(C.recordTypingForAttrs[r]))return Y.resolveKeyData(e);if(t.hasAttribute('class')&&C.recordTypingForClasses&&C.recordTypingForClasses.length>0)for(r=0;r<C.recordTypingForClasses.length;r++)if(H.contains(t.getAttribute('class'),C.recordTypingForClasses[r]))return Y.resolveKeyData(e);var o=B.getElementId(t);if(o&&C.recordTypingForIDs&&C.recordTypingForIDs.length>0)for(r=0;r<C.recordTypingForIDs.length;r++)if(o===C.recordTypingForIDs[r])return Y.resolveKeyData(e);return!1},recordAjaxResource:function(e){Y.addResource('ajax',e.url,e.timestamp)},addResource:function(e,t,n){var r=new p(e,t,n);return Y.reports.resources.push(r),j.emit('timingResource',r),r},saveEvent:function(e){var t=Y.renameEventType(e);if(Y.addEvent(e),z.setRegisteredDebugInfoOnEvent(e),C.debugMode&&(e.report||C.traceMode)){var n=e.type===t?e.type:e.type+'('+t+')',r=!H.isUndefined(e.selectorExpression)&&e.selectorExpression!==w.encoding.rootSelector&&'#document'!==e.selectorExpression;Y.shouldLog(e.type)&&B.log(n+(r?' -> '+e.selectorExpression:'')+Y.eventValueToString(e)+(e.report?'':' [not reported]'),e)}e.report&&j.emit('saveEvent',e)},shouldLog:function(e){return'mousemove'===e?!C.suppressMouseMovesDebug||C.mmDebug:'webSocketFrame'===e?C.wsDebug:'scroll'!==e||C.scrollDebug},renameEventType:function(e){var t=e.type;return H.isUndefined(e.binding)||H.isUndefined(e.binding.logicalName)||(e.type=e.binding.logicalName),t},eventValueToString:function(e){var t=' {V='+(e.value||'NONE');if(e.extraInfo)for(var n in e.extraInfo)e.extraInfo.hasOwnProperty(n)&&(t=t+','+n+'='+e.extraInfo[n]);return null===e.getDebugInfo()||H.isUndefined(e.getDebugInfo())||(t=t+',DI-'+e.getDebugInfo().code),t+='}'},saveDocumentLoadEvent:function(e){var t=Y.createEventObject('document',e,null);t.value=Y.page,t.binding={valueEncoding:K.encodePageDetails},t.shouldEncodeValue=!1,Y.page.title=Y.getPageTitle(),Y.page.title&&t.setExtraInfo(f.prototype.VISUAL_NAME,Y.page.title),Y.documentEvent=t,Y.saveEvent(t),j.emit('event:document')},savePageUpdate:function(){var e=Y.createEventObject('pageUpdate',B.currentTimestamp(),null);Y.saveEvent(e)},onConsoleError:function(e){var t=Y.createEventObject('error',B.currentTimestamp(),null);t.value=e.join(' '),t.shouldEncodeValue=!0,Y.saveEvent(t)},savePageSnapshotEvent:function(e){var t=Y.createEventObject('pageSnapshot',B.currentTimestamp(),null);t.value=e,t.binding={valueEncoding:K.encodePageSnapshotData},t.shouldEncodeValue=!1,Y.saveEvent(t)},saveAjaxRequestEvent:function(e){var t=Y.createEventObject('ajaxRequest',B.currentTimestamp(),null);e.ajaxUrls=Y.ajaxUrls,t.value=e,t.element=e.lastFocusedElement,t.selectorExpression=q.getSelectorExpression(e.lastFocusedElement)||w.encoding.rootSelector,t.binding={valueEncoding:K.encodeAjaxRequest},t.shouldEncodeValue=!1,Y.saveEvent(t)},saveClsDebugErrorEvent:function(e,t,n){var r=Y.formatClsDebugMessage(e,t,n);if(0!==r.length){var o=Y.createEventObject('clsdebug',B.currentTimestamp(),null);o.value=r,Y.saveEvent(o)}},formatClsDebugMessage:function(e,t,n){if(Y.state.clsDebugCounter>=C.clsDebugMaxReports)return'';Y.state.clsDebugCounter++;t.name,t.message;var r=t.name+': '+t.message+(t.stack?' - '+t.stack:'');return r=B.truncateStr(r,C.clsDebugCharsLimit,!0),'CLS Error in '+e+' '+(n?'{'+n+'} ':'')+': '+r},saveWebSocketFrame:function(e){var t=Y.createEventObject('webSocketFrame',B.currentTimestamp(),null);t.value=e,t.binding={valueEncoding:K.encodeWebSocketFrame},t.shouldEncodeValue=!1,Y.saveEvent(t)},eventSaver:function(e,t){return function(n){var r=Y.createEventObject(e,B.currentTimestamp(),null);r.value=n,r.binding={valueEncoding:t},r.shouldEncodeValue=!1,Y.saveEvent(r)}},saveValidationError:function(e){var t=Y.createEventObject('formValidationError',B.currentTimestamp(),null);t.element=e.element,t.value=e.message,t.selectorExpression=e.selector,Y.saveEvent(t)},saveHoverEvent:function(){var e=Y.createEventObject('hover',Y.state.hover.hoverStartTimestamp,null);0!==Y.state.hover.hoverElementList.length?(C.mhDebug&&B.log('saving '+Y.state.hover.hoverElementList.length+' hovers'),e.value=Y.state.hover.hoverElementList,Y.cleanHoverElements(),e.binding={valueEncoding:K.encodeHoverEvent},e.shouldEncodeValue=!1,Y.saveEvent(e)):C.mhDebug&&B.log('no hovers to report')},saveCustomEvent:function(e){var t=Y.createEventObject('custom',B.currentTimestamp(),null);t.value=e,!H.isUndefined(e.domEl)&&B.isDOMElement(e.domEl)&&(t.element=e.domEl,t.selectorExpression=q.getSelectorExpression(e.domEl)||w.encoding.rootSelector),t.binding={valueEncoding:K.encodeCustomEvent},t.shouldEncodeValue=!1,Y.saveEvent(t)},saveThirdPartyEvent:function(e){var t=Y.createEventObject('thirdparty',B.currentTimestamp(),null);t.value=e.value,e.type&&t.setExtraInfo(f.prototype.TP_INTEGRATION_TYPE,e.type),e.element&&(t.element=e.element,t.selectorExpression=q.getSelectorExpression(e.element)||w.encoding.rootSelector),Y.saveEvent(t)},saveThirdPartyMapEvent:function(e){var t=Y.createEventObject('thirdpartymap',B.currentTimestamp(),null);t.value=e.value,t.binding={valueEncoding:K.encodeKVMap},e.type&&t.setExtraInfo(f.prototype.TP_INTEGRATION_TYPE,e.type),e.element&&(t.element=e.element,t.selectorExpression=q.getSelectorExpression(e.element)||w.encoding.rootSelector),t.shouldEncodeValue=!1,Y.saveEvent(t)},saveResourceDataEvent:function(e){var t=Y.createEventObject('resourceContent',B.currentTimestamp(),null);t.value=e,t.binding={valueEncoding:K.encodeResourceContent},t.shouldEncodeValue=!1,Y.saveEvent(t)},initializePageDetails:function(){B.time('initializePageDetails');var e=Y.page;e.initializationTimestamp=B.currentTimestamp(),e.id=B.uuid(),e.frame=window.self!=top,e.frame&&(e.referrerWithoutHash=B.getReferrerUrlWithoutHash());var t=B.getLocationUrlSplitByHash();e.url=t.url,e.urlWithoutHash=t.withoutHash,e.hash=t.hash,e.hasTouch=B.hasTouch(),e.hasTimingAPI=B.hasTimingAPI(),e.eventTypes={clickStart:e.hasTouch?'touchstart':'mousedown',clickEnd:e.hasTouch?B.isHybridAndroid()?'touchmove':'touchend':'mouseup'},e.title=Y.getPageTitle(),B.timeEnd('initializePageDetails')},getPageTitle:function(){return B.truncateStr(n.title,C.titleCharsLimit,!0)},resolvePageLoadTime:function(e){if(e.hasTimingAPI)Y.acquirePerformanceTiming();else{var t=J.get(w.cookies.referrer),r=n.referrer.replace(/#.*/,'');if(t){var o=t.split('_'),i=B.Base64.decode(o[1]);if(r===i){var a=parseInt(o[0],36);e.timing.total=e.loadTimestamp-a,Y.saveTimingEvent({page:e.timing})}else B.log('Referrer does not match referrer stored in timing cookie: '+r+' != '+i)}}},saveTimingEvent:function(e){var t=Y.createEventObject('timing',B.currentTimestamp(),window.document);t.value=e,t.binding={valueEncoding:K.encodeTimings},Y.page.title&&t.setExtraInfo(f.prototype.VISUAL_NAME,Y.page.title),Y.saveEvent(t)},savePerformanceEvent:function(e){var t=Y.createEventObject('performance',B.currentTimestamp(),window.document);window.performance&&window.performance.timing&&(t.value={perf:window.performance,browserTime:e},t.binding={valueEncoding:K.encodePerformanceTimings},Y.page.title&&t.setExtraInfo(f.prototype.VISUAL_NAME,Y.page.title),t.shouldEncodeValue=!1,Y.saveEvent(t))},acquirePerformanceTiming:function(){if(0===window.performance.timing.loadEventEnd)window.setTimeout(Y.acquirePerformanceTiming,300);else{var e=B.currentTimestamp()-Y.page.initializationTimestamp;Y.savePerformanceEvent(e)}},setClientCookies:function(){var e=Y.setVisitorCookie();Y.setClientSessionCookie(e)},setVisitorCookie:function(){var e=J.get(w.cookies.visitor);if(H.isUndefined(e)){var t=B.uuid();return J.setPersistent(w.cookies.visitor,t),B.log('Set cookie with visitor ID: '+t),!0}return!1},setClientSessionCookie:function(e){var t=J.get(w.cookies.session);if(H.isUndefined(t)){var n=B.uuid()+':'+(e?'0':'1');J.set(w.cookies.session,n),B.log('Set cookie with session ID: '+n)}},registerPlugin:function(e,t){Y.plugins[e]=t},removeEventBinding:function(e){for(var t=-1,n=0;n<Y.bindings.registered.length;n++){var r=Y.bindings.registered[n];r.type===e&&(B.removeEventHandler(r.el,e,r.handler),t=n)}t>=0&&Y.bindings.registered.splice(t,1)},removeBindings:function(){H.forEach(Y.bindings.registered,function(e){B.removeEventHandler(e.el,e.type,e.handler)}),Y.bindings.registered=[],Y.bindings.unsupportedEventTypes=[],B.log('Cleared detector bindings.')},getEncoder:function(){return K},supportModeOn:function(e){e=e||!1,Y.applySupportMode(),e&&J.set(w.cookies.supportMode,1)},isSupportModeSession:function(){return void 0!==J.get(w.cookies.supportMode)},checkSupportModeSession:function(){Y.isSupportModeSession()&&Y.applySupportMode()},applySupportMode:function(){C.reportAllOnUnload=!1},tryAttachSnapshotToEvent:function(){var e,t=!1;return function(n){void 0===e&&(e=Y.plugins.domMutationTracker||null),e&&C.domRecordEnabled&&!e.isAborted()&&(t=t||'pageUpdate'===n.type||'mousedown'===n.type||'touchstart'===n.type||'drag'===n.type||'keydown'===n.type||'unload'===n.type)&&-1!==w.snapshotApplicableEventType.indexOf(n.type)&&(n.domSnapshot=e.getDomSnapshot())}}()};p.prototype.toString=function(){return this.url},m.prototype.toString=function(){return'('+this.x+','+this.y+')'};var G={inMemoryMovesCounter:0,notifyEventsFlush:function(){G.inMemoryMovesCounter=0},hasDomUpdate:function(e){return e.domSnapshot&&e.domSnapshot.domChanges},diluteEvents:function(e,t){var n=H.last(e);if(!H.isUndefined(n)){if('resize'===t.type)return'resize'===n.type&&G.removeEventToReport(e,n),!0;if('scroll'===t.type){if('scroll'===n.type||Y.page.hasTouch&&'drag'===n.type)return t.timestamp-n.timestamp>C.minStallingScrollTime||(t.selectorExpression=n.selectorExpression,G.removeEventToReport(e,n),C.scrollDebug&&B.trace('Diluted '+n.type+' event:',n),!0);if('mousemove'===n.type&&1===n.value.length&&e.length>=2){var r=e[e.length-2];if('scroll'===r.type){if(t.timestamp-r.timestamp>C.minStallingScrollTime)return!0;t.selectorExpression=r.selectorExpression,G.removeEventToReport(e,n),G.removeEventToReport(e,r),C.scrollDebug&&B.trace('Diluted scroll & mousemove event (mousewheel rolling)'),G.inMemoryMovesCounter--}}return!0}if('mousemove'===t.type&&'mousemove'===n.type){var o=C.reportByPost?3e3:C.mmMaxMovesInEventWithTimes,i=C.reportByPost?3e3:C.mmMaxMovesInEventNoTimes;return C.mmRecordTimes&&n.value.length>=o||!C.mmRecordTimes&&n.value.length>=i?(C.mmDebug&&B.log('Too much moves in an event: '+n.value.length+'. Starting a new move event.'),G.inMemoryMovesCounter++,!0):!H.isUndefined(C.mmMinStallingMoveTime)&&t.timestamp-n.lastSingleMoveTimestamp>C.mmMinStallingMoveTime?(C.mmDebug&&B.log('Identified mouse move stalling: '+(t.timestamp-n.lastSingleMoveTimestamp)+' ms. Starting a new move event.'),G.inMemoryMovesCounter++,!0):G.checkExceededInMemoryMoves()?(C.mmDebug&&B.log('Exceeded in memory mouse moves ('+C.mmMaxInMemoryMoves+') ignoring...'),!1):(G.removeEventToReport(e,n),G.diluteMoveEvents(n,t)&&G.inMemoryMovesCounter++,!0)}}return'mousemove'===t.type&&G.inMemoryMovesCounter++,!0},removeEventToReport:function(e,t){G.hasDomUpdate(t)||e.splice(H.indexOf(e,t),1)},checkExceededInMemoryMoves:function(){var e=C.reportByPost?3e3:C.mmMaxInMemoryMoves;return G.inMemoryMovesCounter>=e},diluteMoveEvents:function(e,t){var n=H.last(e.value),r=t.value[0],o=t.timestamp-e.lastSingleMoveTimestamp,i=e.getExtraInfo(e.FOCUS_TIME_ATTR);return Math.abs(n.x-r.x)>C.mmDiluteMinPixels||Math.abs(n.y-r.y)>C.mmDiluteMinPixels?(r.t=o,i+=o,t.setExtraInfo(t.FOCUS_TIME_ATTR,i),t.timestamp=e.timestamp,e.value.push(r),t.value=e.value,C.mmDebug&&B.log('updated mousemove value'+t.value),!0):(t.setExtraInfo(t.FOCUS_TIME_ATTR,i),t.timestamp=e.timestamp,t.value=e.value,t.lastSingleMoveTimestamp=e.lastSingleMoveTimestamp,C.mmDebug&&B.log('Diluting mousemove less than '+C.mmDiluteMinPixels+' pixels: '+r),!1)},truncateEventsForUnload:function(e){for(var t=[],n=C.mmMaxMovesWithUnload,r=0,o=!1,i=0;i<e.length;i++){var a=e[i];if('mousemove'===a.type){if(r>=C.mmMaxMovesWithUnload){B.trace(C.mmMaxMovesWithUnload+' moves limit exceeded. dropping mousemove event from unload report... ('+r+' moves dropped)'),o=!0;continue}var s=a.value.length,c=G.truncateMouseMoveEvent(a,n-r);r+=c,c<s&&(o=!0)}'unload'===a.type&&o&&a.setExtraInfo(a.MOVES_TRUNCATED,!0),t.push(a)}return t},truncateMouseMoveEvent:function(e,t){var n=e.value.length;return n<t?n:(B.trace('truncating mousemove on unload ('+n+' > '+t+' moves)'),e.value=e.value.slice(0,t),t)}},J={TLDs:['ac','ad','ae','aero','af','ag','ai','al','am','an','ao','aq','ar','arpa','as','asia','at','au','aw','ax','az','ba','bb','bd','be','bf','bg','bh','bi','biz','bj','bm','bn','bo','br','bs','bt','bv','bw','by','bz','ca','cat','cc','cd','cf','cg','ch','ci','ck','cl','cm','cn','co','com','coop','cr','cu','cv','cx','cy','cz','de','dj','dk','dm','do','dz','ec','edu','ee','eg','er','es','et','eu','fi','fj','fk','fm','fo','fr','ga','gb','gd','ge','gf','gg','gh','gi','gl','gm','gn','gov','gp','gq','gr','gs','gt','gu','gw','gy','hk','hm','hn','hr','ht','hu','id','ie','il','im','in','info','int','io','iq','ir','is','it','je','jm','jo','jobs','jp','ke','kg','kh','ki','km','kn','kp','kr','kw','ky','kz','la','lb','lc','li','lk','lr','ls','lt','lu','lv','ly','ma','mc','md','me','mg','mh','mil','mk','ml','mm','mn','mo','mobi','mp','mq','mr','ms','mt','mu','museum','mv','mw','mx','my','mz','na','name','nc','ne','net','nf','ng','ni','nl','no','np','nr','nu','nz','om','org','pa','pe','pf','pg','ph','pk','pl','pm','pn','pr','pro','ps','pt','pw','py','qa','re','ro','rs','ru','rw','sa','sb','sc','sd','se','sg','sh','si','sj','sk','sl','sm','sn','so','sr','st','su','sv','sy','sz','tc','td','tel','tf','tg','th','tj','tk','tl','tm','tn','to','tp','tr','travel','tt','tv','tw','tz','ua','ug','uk','us','uy','uz','va','vc','ve','vg','vi','vn','vu','wf','ws','xxx','ye','yt','za','zm','zw','servizi'],defaults:{path:'/'},get:function(e){var t=n.cookie;return t!==J._cacheString&&J._populateCache(t),J._cache[e]},set:function(e,t,r){var o={path:r&&r.path||J.defaults.path,domain:r&&r.domain||J.getDefaultDomain(),secure:r&&void 0!==r.secure?r.secure:J.defaults.secure,expires:r&&void 0!==r.expires?r.expires:J.defaults.expires};void 0===t&&(o.expires=-1,t=''),o.expires=J.transformExpiresParameterToStandardForm(o.expires);var i=encodeURIComponent(e)+'='+(t+'').replace(/[^!#-+\--:<-\[\]-~]/g,encodeURIComponent);i+=o.path?';path='+o.path:'',i+=o.domain?';domain='+o.domain:'',i+=o.expires?';expires='+o.expires.toGMTString():'',i+=o.secure?';secure':'',n.cookie=i},expire:function(e,t){return J.set(e,r,t)},transformExpiresParameterToStandardForm:function(e){switch(typeof e){case'number':return new Date(new Date().getTime()+1e3*e);case'string':return new Date(e);}return e},setPersistent:function(e,t,n){var r={expires:n=n||15768e4};J.set(e,t,r)},isClarisiteCookieKey:function(e){for(var t in w.cookies)if(w.cookies.hasOwnProperty(t)&&w.cookies[t]===e)return!0;return!1},_populateCache:function(e){J._cache={},J._cacheString=e;for(var t=J._cacheString.split('; '),n=0;n<t.length;n++){var o,i,a=t[n],s=a.indexOf('=');try{if(o=decodeURIComponent(a.substr(0,s)),!J.isClarisiteCookieKey(o))continue;i=decodeURIComponent(a.substr(s+1))}catch(e){B.log('Error: Failed decoding a cookie '+(o?'[key='+o+']':'')+' from document.cookie: '+a,e);continue}J._cache[o]===r&&(J._cache[o]=i)}},getDefaultDomain:function(){return H.isString(J.defaults.domain)||(J.defaults.domain=J.constructCookiesTopLevelDomain(),B.log('Set default cookie domain to: '+J.defaults.domain)),J.defaults.domain},validateTLD:function(e,t){var n=t.indexOf(e);return-1===n||n+e.length!==t.length?(B.log('invalid TLD: hostname suffix mismatch. TLD:'+e),!1):!(t.split('.').length-e.split('.').length>1)||(B.log('invalid TLD: hostname segment count is larger by more than one. TLD:'+e),!1)},constructCookiesTopLevelDomain:function(){var e=C.customTLD||J.resolveTopLevelDomain(window.location.host);return e&&'localhost'!==e&&J.validateTLD(e,window.location.host)?'.'+e:null},resolveTopLevelDomain:function(e){var t=e.indexOf(':');-1!==t&&(e=e.slice(0,t));var n=e.split('.');'www'===n[0]&&'com'!==n[1]&&n.shift();for(var r,o=n.length,i=o,a=n[o-1].length,s=[];r=n[--i];)if(s.unshift(r),0===i||i<o-2||r.length<a||H.indexOf(J.TLDs,r,!0)<0)return s.join('.');return B.log('Failed resolving top level domain for host: '+e),null}};g.prototype.get=function(e){return this.map[e]},g.prototype.set=function(e,t){this.map[e]=t,this.writeToCookie()},g.prototype.toMap=function(e){if(H.isUndefined(e))return{};for(var t=e.split(';'),n=0;n<t.length;n++){var r=t[n].split(':');2!==r.length?B.log('Bad format in parsing cookie string: '+e):this.set(r[0],r[1])}return this.map},g.prototype.toString=function(){var e='';for(var t in this.map)this.map.hasOwnProperty(t)&&(e+=(0===e.length?'':';')+t+':'+this.map[t]);return e},g.prototype.readFromCookie=function(){return this.toMap(J.get(this.cookieName))},g.prototype.writeToCookie=function(){J.set(this.cookieName,this.toString())};var Q={BT:{CLICKS_WITH_NO_MOUSE_MOVES:{code:'1',active:!0},NOT_TRUSTED_MOUSEEVENT:{code:'3',active:!0},INVALID_NAVIGATION_API_VALUES:{code:'4',active:!0},MOVE_AND_CLICK_SAME_COORDINATES_AND_TIMES:{code:'5',active:!0}},HU:{MANY_MOUSE_MOVES_BETWEEN_CLICKS:{code:'-1',active:!0}},mouseMoveOccurred:!1,mouseEnterOccurred:!1,mouseDownOccurred:!1,lastMouseDownCoordinate:null,firstMoveCoordinate:null,firstMoveTimestamp:0,mouseMoveClickAllowedTimeDiff:100,mouseMovesCounter:0,detected:{robot:!1,human:!1},active:!1,session:{map:new g(w.cookies.robot),names:{DETECT:'d',NON_HUMAN_COUNT:'nh'}},init:function(){if(Q.isSessionDetected()){var e=Q.isSessionRobotDetected();B.log('Session was already detected as: '+(e?'BOT':'HUMAN'))}else Q.active=!0,Q.createMouseHandlers()},stopDetection:function(){Q.removeAllHandlers(),Q.active=!1},isActive:function(){return Q.active},createMouseHandlers:function(){B.addEventHandler(n.body,'mousemove',Q.mouseMoveHandler,!0),B.addEventHandler(n.body,'click',Q.mouseClickHandler,!0)},mouseMoveHandler:function(e){return Q.mouseMoveOccurred||(Q.firstMoveCoordinate=B.getCoordinate(e),Q.firstMoveTimestamp=B.currentTimestamp()),Q.mouseMoveOccurred=!0,Q.mouseDownOccurred&&Q.mouseMovesCounter++,!0},mouseEnterHandler:function(){return Q.mouseEnterOccurred=!0,Q.removeMouseHandler('mouseenter',Q.mouseEnterHandler),!0},mouseClickHandler:function(e){return Q.notifyMouseAction(e),!0},removeAllHandlers:function(){Q.removeMouseHandler('mousemove',Q.mouseMoveHandler),Q.removeMouseHandler('click',Q.mouseClickHandler)},removeMouseHandler:function(e,t){try{B.removeEventHandler(n.body,e,t)}catch(t){B.log('BotDetector failed to remove '+e+' listener. '+t.message(),t)}},checkTrusted:function(e){Q.BT.NOT_TRUSTED_MOUSEEVENT.active&&'isTrusted'in e&&!1===e.isTrusted&&Q.robotDetected(Q.BT.NOT_TRUSTED_MOUSEEVENT)},checkMouseMovesBetweenClicks:function(e){if('mousedown'===e.type){Q.mouseDownOccurred=!0;var t=B.getCoordinate(e);null!==Q.lastMouseDownCoordinate?Q.HU.MANY_MOUSE_MOVES_BETWEEN_CLICKS.active&&!B.isSameCoordinates(t,Q.lastMouseDownCoordinate)?Q.mouseMovesCounter>=10&&Q.humanDetected(Q.HU.MANY_MOUSE_MOVES_BETWEEN_CLICKS):Q.BT.CLICKS_WITH_NO_MOUSE_MOVES.active&&B.isCoordinatesDistLargerThan(t,Q.lastMouseDownCoordinate,10)&&0===Q.mouseMovesCounter&&Q.robotDetected(Q.BT.CLICKS_WITH_NO_MOUSE_MOVES):Q.mouseMoveOccurred&&Q.checkDifferentCoordinatesAndTimes(e),Q.mouseMovesCounter=0,Q.lastMouseDownCoordinate=t}},checkDifferentCoordinatesAndTimes:function(e){if(Q.BT.MOVE_AND_CLICK_SAME_COORDINATES_AND_TIMES.active){var t=B.getCoordinate(e);if(null!==Q.firstMoveCoordinate&&B.isSameCoordinates(t,Q.firstMoveCoordinate)&&B.currentTimestamp()-Q.firstMoveTimestamp<Q.mouseMoveClickAllowedTimeDiff){var n=Q.session.map.get(Q.session.names.NON_HUMAN_COUNT);if(H.isUndefined(n))Q.session.map.set(Q.session.names.NON_HUMAN_COUNT,1);else{var r=parseInt(n);isNaN(r)&&(B.log('Bad format of non human counter in the robot cookie: '+Q.session.map.toString()),r=1),r++,Q.session.map.set(Q.session.names.NON_HUMAN_COUNT,r),Q.robotDetected(Q.BT.MOVE_AND_CLICK_SAME_COORDINATES_AND_TIMES),Q.BT.MOVE_AND_CLICK_SAME_COORDINATES_AND_TIMES.active=!1}}}},notifyMouseAction:function(e){'mousedown'===e.type&&Q.checkMouseMovesBetweenClicks(e),Q.checkTrusted(e)},notifyInvalidNavigationAPIValues:function(){Q.BT.INVALID_NAVIGATION_API_VALUES.active&&Q.robotDetected(Q.BT.INVALID_NAVIGATION_API_VALUES)},reportRobotDetection:function(e){var t=Y.createEventObject('botDetection',B.currentTimestamp(),null);t.value=e.code,t.shouldEncodeValue=!1,Y.saveEvent(t)},robotDetected:function(e){Q.active&&(B.log('BotDetector has detected a bot with type: '+e.code),Q.reportRobotDetection(e),e.active=!1,Q.markSession(Q.session.names.DETECT,e.code),Q.detected.robot=!0,Q.stopDetection())},humanDetected:function(e){B.log('Human Detected ['+e.code+']'),Q.detected.human=!0,Q.markSession(Q.session.names.DETECT,e.code),Q.stopDetection()},markSession:function(e,t){Q.session.map.set(e,t)},isSessionDetected:function(){var e=Q.session.map.get(Q.session.names.DETECT);return!H.isUndefined(e)},isSessionRobotDetected:function(){var e=Q.session.map.get(Q.session.names.DETECT);if(H.isUndefined(e))return!1;var t=parseInt(e);return!isNaN(t)&&t>0},isSessionHumanDetected:function(){var e=Q.session.map.get(Q.session.names.DETECT);if(H.isUndefined(e))return!1;var t=parseInt(e);return!isNaN(t)&&t<0}};Y.checkElementChangebility=function(e){var t=e.nodeName,n=e.type,r=!1,o=!1;switch(t){case'SELECT':o=!0;break;case'TEXTAREA':r=!0;break;case'INPUT':if(null===n)break;switch(n){case'checkbox':case'radio':o=!0;break;case'text':case'password':case'number':case'file':case'url':case'search':case'email':case'date':case'time':case'tel':case'range':case'month':case'week':case'datetime':case'datetime-local':case'color':r=!0;}}return{isTypable:r,isSelectable:o}},Y.isTypableElement=function(e){return Y.checkElementChangebility(e).isTypable},Y.isSelectableElement=function(e){return Y.checkElementChangebility(e).isSelectable},Y.isChangebleElement=function(e){return Y.isTypableElement(e)||Y.isSelectableElement(e)},Y.directValueInputTypes=['text','number','file','url','search','email','date','time','tel','range','month','week','datetime','datetime-local','color','radio'],Y.extractElementValue=function(e,t){var n=t.nodeName,r=C.maskingMode===w.MaskingMode.WhiteList;if(t.hasAttribute(w.maskingAttribute)||B.hasClassName(t,'cls_mask')?r=!0:C.maskList&&H.contains(C.maskList,B.getElementId(t))?r=!r:C.maskClassList&&B.hasOneOfClassNames(t,C.maskClassList)&&(r=!r),r){var o=t.value;return'string'==typeof o?new Array(o.length+1).join('*'):void B.log('Error masking value for element:  '+(elementId||t)+' . Value is not a String.')}if('INPUT'===n){var i=t.type;if(H.contains(Y.directValueInputTypes,i))return t.value;if('checkbox'===i)return t.checked?'true':'false';if('password'===i){var a=t.value;if(C.extractPasswords)return a;if('string'==typeof a)return new Array(a.length+1).join('*')}}else{if('TEXTAREA'===n)return t.value;if('SELECT'===n){var s=t.options;if(!H.isUndefined(s)&&'number'==typeof s.length&&s.length>0){if(!H.isUndefined(t.multiple)&&t.multiple)return'['+Y.extractMultipleSelectValues(s).join(',')+']';if(!H.isUndefined(t.selectedIndex)&&!H.isUndefined(s[t.selectedIndex]))return s[t.selectedIndex].value}}}},Y.extractElementSource=function(e,t){var n=t.src||t.href;return H.isUndefined(n)||null==n?void 0:n},Y.extractLocationHash=function(e,t){return B.getLocationUrlSplitByHash().hash},Y.extractMultipleSelectValues=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.selected&&t.push(r.value)}return t},Y.extractScrollValue=function(e,t){if('#document'===t.nodeName){var n=B.getScrollTopLeft();return new m(n.left,n.top)}return new m(t.scrollLeft,t.scrollTop)},Y.extractMouseMoveValue=function(e,t){return[B.getCoordinate(e)]},Y.extractErrorValue=function(e,t){var n='';return'string'==typeof e.message&&(n+=e.message),'string'==typeof e.url?n+='; URL: '+e.url:'string'==typeof e.filename&&(n+='; FILE: '+e.filename),'number'==typeof e.lineno&&(n+='; L: '+e.lineno),'number'==typeof e.colno&&(n+='; C: '+e.colno),n},f.prototype={toString:function(){return this.type},setExtraInfo:function(e,t){H.isUndefined(t)?B.log('Failed setting value for extra info attribute: '+e+'. Value is undefined'):(H.isUndefined(this.extraInfo)&&(this.extraInfo={}),this.extraInfo[e]=t)},getExtraInfo:function(e){if(H.isUndefined(this.extraInfo))return null;var t=this.extraInfo[e];return void 0===t?null:t},setDebugInfo:function(e){H.isUndefined(this.debugInfo)&&(this.debugInfo={}),this.debugInfo=e},getDebugInfo:function(){return this.debugInfo},getSubPage:function(){return this.subPage},addHybridActionDataItem:function(e,t){H.isUndefined(t)?B.log('Failed setting value for hybrid action data item: '+e+'. Value is undefined'):(H.isUndefined(this.hybridActionData)&&(this.hybridActionData={}),this.hybridActionData[e]=t)},getdHybridActionData:function(){return this.hybridActionData}},f.prototype.FOCUS_TIME_ATTR='focusTime',f.prototype.AUTO_COMPLETE_ATTR='autoComplete',f.prototype.VISUAL_NAME='visualName',f.prototype.TIME_SINCE_LAST_EVENT='timeSinceLastIdle',f.prototype.COORDINATE_ATTR='coordinate',f.prototype.SCROLL_REACH='scrollReach',f.prototype.MOVES_TRUNCATED='truncated',f.prototype.LOST_EVENTS_NUM='lostEvents',f.prototype.TP_INTEGRATION_TYPE='tpIntegrationType',f.prototype.EXTERNAL_ID='externalId',f.prototype.SYNC_COORDINATE='syncCoordinates',f.prototype.extraInfoAttrs=[{name:f.prototype.FOCUS_TIME_ATTR,encodeName:'ft',encodeFunc:K.encodeNumber,encodeCode:w.dictionary.encodeEncodingType('cd_number')},{name:f.prototype.AUTO_COMPLETE_ATTR,encodeName:'ac',encodeFunc:K.encodeBoolean,encodeCode:w.dictionary.encodeEncodingType('cd_boolean')},{name:f.prototype.VISUAL_NAME,encodeName:'vn',encodeFunc:K.encodeString,encodeCode:w.dictionary.encodeEncodingType('cd_string')},{name:f.prototype.TIME_SINCE_LAST_EVENT,encodeName:'tl',encodeFunc:K.encodeNumber,encodeCode:w.dictionary.encodeEncodingType('cd_number')},{name:f.prototype.COORDINATE_ATTR,encodeName:'co',encodeFunc:K.encodeCoordinate64,encodeCode:w.dictionary.encodeEncodingType('cd_coordinate')},{name:f.prototype.SCROLL_REACH,encodeName:'sr',encodeFunc:K.encodeNumber,encodeCode:w.dictionary.encodeEncodingType('cd_number')},{name:f.prototype.MOVES_TRUNCATED,encodeName:'tr',encodeFunc:K.encodeBoolean,encodeCode:w.dictionary.encodeEncodingType('cd_boolean')},{name:f.prototype.LOST_EVENTS_NUM,encodeName:'le',encodeFunc:K.encodeNumber,encodeCode:w.dictionary.encodeEncodingType('cd_number')},{name:f.prototype.TP_INTEGRATION_TYPE,encodeName:'tp',encodeFunc:K.encodeString,encodeCode:w.dictionary.encodeEncodingType('cd_string')},{name:f.prototype.EXTERNAL_ID,encodeName:'ei',encodeFunc:K.encodeString,encodeCode:w.dictionary.encodeEncodingType('cd_string')},{name:f.prototype.SYNC_COORDINATE,encodeName:'sy',encodeFunc:K.encodeCoordinate64,encodeCode:w.dictionary.encodeEncodingType('cd_coordinate')}];var Z={showErrorsLRU:new s(20),initialize:function(e){return!!C.reportValidationErrors&&(e.on('init:loaded',Z.intercept),!0)},intercept:function(){if(Z.jqueryValidatorExist()){B.log('Intercepting jQuery Validator errors.');var e=jQuery.validator.prototype.showErrors;jQuery.validator.prototype.showErrors=function(t){try{if(this.errorList&&this.errorList.length>0)for(var n=0;n<this.errorList.length;n++){var r=this.errorList[n].element,o=this.errorList[n].message,i='SAME - NOT REPORTING',a=q.getSelectorExpression(r)||w.encoding.rootSelector,s=Z.showErrorsLRU.set(a,o);if(null===s||H.isUndefined(s))i='NEW';else if(s!==o)i='UPDATE';else if(s===o){var c=this.errorsFor(r);c&&c.length>0&&!H.isUndefined(c[0].innerHTML)&&(c[0].innerHTML===o&&jQuery(c[0]).is(':visible')||(i='SHOW'))}var l=new v(r,o,a);B.trace('Validation error identified: '+l+' | '+i),'NEW'!==i&&'UPDATE'!==i&&'SHOW'!==i||j.emit('jquery:validationError',l)}}catch(e){B.log('Failed intercepting showErrors for validation error report. '+e.message,e)}e.call(this,t)}}},jqueryValidatorExist:function(){try{return jQuery.validator}catch(e){return!1}}};v.prototype.toString=function(){var e=B.getElementId(this.element);return(e||(this.element.name?this.element.name:this.element))+' > "'+this.message+'"'},Y.registerPlugin('formValidationInterceptor',Z);var $={initialize:function(e){return!(!C.SCIntegration||void 0===C.SCIntegrationURLsContainList||void 0===C.SCIntegrationKeyList||0===C.SCIntegrationKeyList.length)&&(e.on('init:preloaded',$.intercept),B.log('Intercepting SiteCatalyst reports.'),!0)},intercept:function(){var e=window.Image;window.Image=function(t,n){var r=function(){try{if(o.src&&X.isUrlToReport(o.src,C.SCIntegrationURLsContainList)){B.trace('Image thirdparty intercepted: '+o.src);var e=X.parseToKVMap(o.src,C.SCIntegrationKeyList);if(e){var t=new E(e);j.emit('3rdpartymap:scReport',t)}}}catch(e){B.log('Error while checking image '+o.src+' for SC integration: '+e.message,e)}},o=new e(t,n);try{o.addEventListener('load',r)}catch(e){B.log('Failed intercepting Image constructor for SC integration. '+e.message,e)}return o}}};E.prototype.toString=function(){return this.type+': '+this.data},Y.registerPlugin('SCIntegration',$),Y.extractVisualName=function(e,t){if(t&&B.isElement(t)&&!H.contains(C.visualName.filterNamingByTagName,t.tagName.toLocaleLowerCase())){var n='',r=B.getAttributeForElement(t,C.visualName.CLS_NAME_ATTR);r&&(n='by cls_vname'),!r&&C.visualName.by.title&&(r=B.getAttributeForElement(t,'title'))&&(n='by title'),!r&&C.visualName.by.alt&&(r=B.getAttributeForElement(t,'alt'))&&(n='by alt'),!r&&C.visualName.by.ariaLabel&&(r=B.getAttributeForElement(t,'aria-label'))&&(n='by aria-label'),!r&&C.visualName.by.inlineText&&(r=Y.getInlineText(t))&&(n='by #text'),!r&&C.visualName.by.placeholder&&(r=B.getAttributeForElement(t,'placeholder'))&&(n='by placeholder'),r||!C.visualName.by.inputConsts&&!C.visualName.by.inputButtonsValue||(r=Y.getInputNames(t))&&(n='by input specific'),!r&&C.visualName.by.name&&(r=B.getAttributeForElement(t,'name'))&&(n='by name'),!r&&C.visualName.by.id&&(r=B.getAttributeForElement(t,'id'))&&(n='by id'),!r&&C.visualName.by.parent&&(r=Y.getVNByParent(t))&&(n='by parent'),!r&&C.visualName.by.child&&(r=Y.getVNByChild(t))&&(n='by child'),r?(r.length>C.visualName.chatLimit&&(r=r.substr(0,C.visualName.chatLimit).concat('...')),e.setExtraInfo(f.prototype.VISUAL_NAME,r),C.visualNameDebug&&B.trace('VISUAL NAME: ('+e.type+' on '+t.tagName+' '+(t.type?t.type:'')+') '+n+' - '+r)):C.visualNameDebug&&B.trace('VISUAL NAME: ('+e.type+' on '+t.tagName+' '+(t.type?t.type:'')+') ----- NOT FOUND')}},Y.getVNByChild=function(e){if(!H.contains(C.visualName.elementListToCheckChild,e.tagName.toLocaleLowerCase()))return null;var t;if(1===e.childElementCount){var n=e.firstElementChild;t=B.getAttributeForElement(n,'title')||B.getAttributeForElement(n,'alt')||B.getAttributeForElement(n,'aria-label')||B.getAttributeForElement(n,'name')||B.getAttributeForElement(n,'id')}return t||null},Y.getVNByParent=function(e){if(!H.contains(C.visualName.elementListToCheckParent,e.tagName.toLocaleLowerCase()))return null;var t=null,n=e.parentElement;return!n||'a'!==n.tagName.toLocaleLowerCase()&&'button'!==n.tagName.toLocaleLowerCase()||(t=B.getAttributeForElement(n,'title')||B.getAttributeForElement(n,'alt')||B.getAttributeForElement(n,'aria-label')||B.getAttributeForElement(n,'name')||B.getAttributeForElement(n,'id')),t||null},Y.getInlineText=function(e){var t=e.tagName.toLocaleLowerCase();if('td'===t)return null;var n=B.getAttributeForElement(e,'class');if(n&&H.contains(C.visualName.filterInlineTextByClassName,n))return null;var r;if(('span'===t||'div'===t)&&1===e.childElementCount&&(r=e.firstElementChild)&&'a'===r.tagName.toLocaleLowerCase()&&0===r.childElementCount){var o=r.innerText;return o&&(o=B.trim(o)),o||null}if(H.contains(C.visualName.filterInlineTextByTagName,t)){var i=e.parentElement?e.parentElement.tagName.toLocaleLowerCase():'';if('a'!==i&&'button'!==i)return null}var a=null;return 0===e.childElementCount&&(a=e.innerText)&&(a=B.trim(a)),a||1===e.childElementCount&&0===(r=e.firstElementChild).childElementCount&&(a=r.innerText)&&(a=B.trim(a)),a||null},Y.getInputNames=function(e){var t;if('input'===e.tagName.toLocaleLowerCase()){var n=e.type.toLocaleLowerCase();if('button'!==n&&'submit'!==n&&'reset'!==n||!C.visualName.by.inputButtonsValue||(t=e.value),!t&&C.visualName.by.inputConsts)switch(n){case'password':t='Password';break;case'button':case'submit':case'image':t='Submit';break;case'file':t='Choose File';break;case'reset':t='Reset';}}return t&&(t=B.trim(t)),t||null},Y.triggerCustomEvent=function(e,t,n){try{if(H.isUndefined(e)||!H.isString(e)||0===e.length||H.isUndefined(t))return void B.log('triggerCustomEvent: bad argument: eventName='+e+' eventValue='+t);var r={name:''+e,val:''+t,domEl:n};Y.saveCustomEvent(r)}catch(r){B.log('triggerCustomEvent: error while triggering event with name='+e+' value='+t+'domElement='+n,r.stack?r.stack:r.message)}},Y.fetchAll=function(){try{staticResourceFetcher.fetchAll()}catch(e){B.log('fetchAll: Error while fetching resources. ',e.stack?e.stack:e.message)}},Y.fetchLog=function(){try{staticResourceFetcher.fetchLog()}catch(e){B.log('fetchLog: Error while logging resources. ',e.stack?e.stack:e.message)}},Y.fetchStatus=function(){try{staticResourceFetcher.fetchStatus()}catch(e){B.log('fetchStatus: Error while logging resources. ',e.stack?e.stack:e.message)}};var ee={handlers:{open:[],send:[],load:[],error:[]},blackList:['adrum','dynatrace','appdynamics.com','tealeaf','/retail/discountinternet/portal/coex.asmx/keepalive'],initialize:function(e){return!!C.interceptAjax&&(ee.supportAjaxOnProgressEvents()?(e.on('init:preloaded',ee.intercept),B.log('Intercepting AJAX calls.'),!0):(B.log('Ajax interception not supported.'),!1))},isClsOwnAjax:function(e){return e.cls_own},intercept:function(){var e=XMLHttpRequest.prototype.open,t=XMLHttpRequest.prototype.send;e&&t?(XMLHttpRequest.prototype._oldOpen=e,XMLHttpRequest.prototype._oldSend=t,XMLHttpRequest.prototype.open=function(){var e=this;if(!ee.isClsOwnAjax(e)){var t;try{e.interception={},arguments.length>0&&(e.interception.method=arguments[0]),arguments.length>1&&('object'==typeof(t=arguments[1])&&(t=t.toString()),e.interception.url=t),arguments.length>2&&(e.interception.async=arguments[2]),e.interception.uuid=B.uuid(),j.emit('ajax:open',new y(e,B.currentTimestamp())),C.ajaxDebug&&B.trace('AJAX open intercepted',e)}catch(e){B.log('Exception occurred when intercepting ajax \'open\' for url: '+t+' Error: '+e.message,e)}}XMLHttpRequest.prototype._oldOpen.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){var e=this;if(e.interception&&ee.shouldIgnoreAjaxUrl(e.interception.url))B.trace('Ajax filter black-listed url: '+e.interception.url);else if(!ee.isClsOwnAjax(e)){try{var t=arguments[0],r=new y(e,B.currentTimestamp());arguments.length>0&&(r.data=t),j.emit('ajax:send',r),C.ajaxDebug&&B.trace('AJAX send intercepted',e)}catch(e){B.log('Exception occurred when intercepting ajax \'send\'.  Error: '+e.message,e)}var o=function(){j.emit('ajax:load',new y(e,B.currentTimestamp())),C.ajaxDebug&&B.trace('AJAX load intercepted',e)},i=function(){j.emit('ajax:error',new y(e,B.currentTimestamp())),C.ajaxDebug&&B.trace('AJAX error intercepted',e)},a=function(){C.ajaxDebug&&B.trace('AJAX onLoadstart intercepted',e),e.interception?(e.interception.startTime=B.currentTimestamp(),e.interception.lastFocusedElement=n.activeElement):B.trace('AJAX onLoadstart - missing cls xhr interception data')},s=function(){if(C.ajaxDebug&&B.trace('AJAX onLoadend intercepted',e),e.interception){var t=B.currentTimestamp(),n=new y(e,t);e.interception.startTime>0?n.duration=t-e.interception.startTime:n.duration=-1,n.lastFocusedElement=e.interception.lastFocusedElement,n.status=e.status,n.statusText=e.statusText,j.emit('ajax:loadend',n)}else B.trace('AJAX onLoadend - missing cls xhr interception data for url: '+(e.responseURL||''))};try{e.addEventListener('load',o,!1),e.addEventListener('error',i,!1),e.addEventListener('loadstart',a,!1),e.addEventListener('loadend',s,!1)}catch(e){B.log('Exception occurred when intercepting ajax \'send\'.  Error: '+e.message,e)}}XMLHttpRequest.prototype._oldSend.apply(this,arguments)}):B.log('WARNING: cannot intercept ajax, XMLHttpRequest prototype was altered (likely, by some loaded earlier 3rd party library).')},supportAjaxOnProgressEvents:function(){return'onloadend'in new XMLHttpRequest},shouldIgnoreAjaxUrl:function(e){for(var t=e.toLowerCase(),n=0;n<ee.blackList.length;n++)if(t.indexOf(ee.blackList[n])>=0)return!0;return!1}};y.prototype.toString=function(){return this.method+' '+this.url+(this.duration?' '+this.duration+'ms.':'')+(this.status?' '+this.status:'')},Y.registerPlugin('ajaxInterceptor',ee);var te={initialize:function(e){return!!C.recordWebSocket&&(window.WebSocket?(e.on('init:preloaded',te.intercept),B.log('Intercepting WebSocket frames.'),!0):(B.log('This browser does not support WebSocket.'),!1))},intercept:function(){var e=window.WebSocket,t=e.prototype.send;if(t){var n={},r=function(e){return''!==e},o=function(e){var t=e.split(/:\/\/|[^a-zA-Z\d]/).filter(r).join('_'),o=n[t]||0;return n[t]=o+1,o+'_'+t};window.WebSocket=function(t,n){var r=n?new e(t,n):new e(t);try{r._id=o(r.url),B.log('WebSocket creation intercepted. id: '+r._id);var i=function(e){var t=new T(r._id,!0,e.data,B.currentTimestamp());j.emit('websocket:frame',t)},a=function(e){var t=new b(r._id,e,B.currentTimestamp());B.trace('WebSocket open intercepted',r._id),j.emit('websocket:open',t)},s=function(e){var t=new b(r._id,e,B.currentTimestamp());B.trace('WebSocket close intercepted',r._id,e.reason),j.emit('websocket:close',t)},c=function(e){var t=new b(r._id,e,B.currentTimestamp());B.trace('WebSocket error intercepted, id: ',r._id),j.emit('websocket:error',t)};r.addEventListener('message',i),r.addEventListener('open',a),r.addEventListener('close',s),r.addEventListener('error',c)}catch(e){B.log('failed intercepting WebSocket constructor: '+e.message,e)}return r},WebSocket.prototype=e.prototype,WebSocket.prototype.constructor=WebSocket,WebSocket.prototype.send=function(){if(this._id){var e=new T(this._id,!1,arguments[0],B.currentTimestamp());j.emit('websocket:frame',e)}else B.log('target WebSocket has no assigned id (not hooked by the detector - check detector\'s execution timing).');return t.apply(this,[].slice.call(arguments))},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3}else B.log('WARNING: cannot intercept WS communication, WebSocket prototype was altered (likely, by some loaded earlier 3rd party library).')}};b.prototype.toString=function(){return this.id+' '+this.event.type},T.prototype.isBinary=function(){return!H.isString(this.payload)},T.prototype.toString=function(){return this.id+' '+(this.direction?'IN':'OUT')+' '+(this.isBinary()?'[BINARY]':'[TEXT]')+(this.isBinary()?'len:'+this.payload.byteLength:'payload:'+this.payload)},void 0!==Y&&Y.registerPlugin('webSocketInterceptor',te),S.READY_COOKIE='_cls_ready',S.STATE={INIT:0,HELPING:1,READY:2};var ne={name:'POST',ready:!0,corsHelper:new S(n,window.location,C.reportURI,new d(C.reportAddUriParams)),uriPolicy:new d(C.reportAddUriParams),config:{maxReportSize:C.maxPostReportSize,maxReports:-1},gainLockToReport:function(){var e=ne.ready;return e&&ne.setReady(!1),e},freeLock:function(){ne.setReady(!0)},setReady:function(e){ne.ready=e},flushEvents:function(e,t){ne.corsHelper.isRequired()&&!ne.corsHelper.isReady()?ne.corsHelper.help(V.createXMLHTTPObject,function(n){ne.createRequest(e,t,n)}):ne.createRequest(e,t,ne.corsHelper.isRequired())},createRequest:function(e,t,n,r){e=e||'',r=r||!1;var o=oe.baseURI,i=V.createXMLHTTPObject();if(!i)return B.log('Failed creating an XMLHttpRequest object'),void ne.setReady(!0);i.onreadystatechange=function(){4===i.readyState&&(200===i.status?ne.setReady(!0):C.postRetry&&!r?(B.log('Failed POST data ('+t+'): '+i.status+'  '+i.statusText+' ...retrying...'),ne.createRequest(e,t,n,!0)):(ne.addFailNotesOnCookie(t,i.status,i.statusText),B.log('Failed '+(r?'again ':'')+'POST data ('+t+'): '+i.status+'  '+i.statusText+' . aborting. '),i.abort(),ne.setReady(!0)))};try{i.cls_own=!0,i.open('POST',ne.uriPolicy.apply(o),!0),i.onprogress=function(){},i.ontimeout=function(){},i.onerror=function(){},i.withCredentials=n,beaconEncodingManager.encoder.visitXhr(i),setTimeout(function(){try{i.send(e)}catch(e){B.log('Failed sending (in) POST request ('+t+') to url '+o+': '+e.message,e),ne.setReady(!0)}},0)}catch(e){B.log('Failed sending POST request ('+t+') to url '+o+': '+e.message,e),ne.setReady(!0)}},addFailNotesOnCookie:function(e,t,n){var r=J.get(w.cookies.debuginfo)||'';if(!(r.length>50)){var o='';-1!==r.indexOf('|')&&(o=r.substring(0,r.indexOf('|')));var i=(o?'.':'')+e+'|E'+t;J.set(w.cookies.debuginfo,o+i)}}},re={name:'GET',domBeaconImgNum:0,uriPolicy:new d(C.reportAddUriParams),config:{maxReportSize:C.maxReportSize,maxReports:-1},gainLockToReport:function(){return!0},freeLock:function(){},flushEvents:function(e,t){var n=oe.baseURI+e;re.createRequest(re.uriPolicy.apply(n))},createRequest:function(e){C.DOMBeaconImg?re.changeImgSrcByDOM(e):re.createImageWithSrc(e)},createImageWithSrc:function(e){new Image().src=e},changeImgSrcByDOM:function(e){var t='_cls_beacon_img_'+new Date().getTime()+' '+re.domBeaconImgNum++,r=n.getElementById(t);null===r&&((r=n.createElement('img')).id=t,r.style.width='1px',r.style.height='1px',r.style.visibility='hidden',r.style.position='fixed',n.body&&n.body.appendChild(r)),r.src=e}},oe={eventsToReport:[],freshEventsNum:0,reporter:C.reportByPost?ne:re,sequenceNumber:0,lastSnapshotEnabledStepType:null,lastPageSnapshotSequence:-1,initialize:function(e){if(!H.isUndefined(C.reportURI)&&0!==C.reportURI.length)return B.log('Reporting using: '+(C.reportByPost?'POST':'GET')),B.log('Report Encoding: '+beaconEncodingManager.encoder.name),B.log('Report Compression: '+(C.reportCompress?'ENABLED':'DISABLED')+' supported by encoder:'+beaconEncodingManager.encoder.supportsCompression),oe.baseURI=C.reportURI,C.reportByPost||(oe.baseURI+=-1!==C.reportURI.indexOf('?')?'&':'?'),oe.pageId=Y.page.id,oe.idleLatestEventTime=oe.idleBaseTime=B.currentTimestamp(),oe.freshStartInd=0,e.on('init:loaded',oe.startTimer),e.on('saveEvent',oe.saveEvent),e.on('event:document',oe.reportOnLoad),e.on('event:unload',oe.reportOnUnload),e.on('event:beforeunload',oe.reportOnUnload),e.on('reportImmediately',oe.reportImmediately),e.on('pageSnapshot:report',oe.onPageSnapshot),!0},onPageSnapshot:function(e){oe.reportImmediately(),J.set(w.cookies.sub_session,B.uuid()),e.cookie=n.cookie,oe.lastPageSnapshotSequence=e.seq},startTimer:function(){var e=C.reportByPost?C.reportPostInterval:C.reportInterval;e&&!oe.timer&&(oe.timer=setInterval(oe.reportQueuedEvents,e),B.log('Beacon: events will be reported in intervals of '+e+' ms.'))},saveEvent:function(e){G.diluteEvents(oe.eventsToReport,e)&&(Y.tryAttachSnapshotToEvent(e),oe.eventsToReport.push(e)),oe.elapseIdleTimes()},reportOnLoad:function(e){C.reportAllOnUnload&&oe.reportQueuedEvents(!0)},reportOnUnload:function(e){B.log('Beacon: unload received, '+oe.eventsToReport.length+' events to report.'),oe.reportQueuedEventsUnload()},reportQueuedEventsUnload:function(){oe.eventsToReport.length>0&&(C.reportAllOnUnload||!C.truncateEventsWithUnload||C.reportByPost||(oe.eventsToReport=G.truncateEventsForUnload(oe.eventsToReport)),oe.reportAllCollectedEvents(!0))},hasDependentEventsOnly:function(e,t){for(var n=t;n<e.length;n++)if(!e[n].dependent)return!1;return!0},reportImmediately:function(){oe.reportQueuedEvents(!0)},reportQueuedEvents:function(e){try{if(e&&oe.eventsToReport.length>0)return void oe.reportAllCollectedEvents();if(oe.eventsToReport.length>oe.freshStartInd)return C.reportAllOnUnload?void(oe.freshStartInd=oe.eventsToReport.length):oe.hasDependentEventsOnly(oe.eventsToReport,oe.freshStartInd)?void(oe.freshStartInd=oe.eventsToReport.length):void oe.reportAllCollectedEvents();C.idleEventTimeInterval>0&&B.currentTimestamp()-oe.idleLatestEventTime>=C.idleEventTimeInterval&&B.currentTimestamp()-oe.idleBaseTime<C.maxTimeForIdleEvent&&(oe.reportIdleEvent(oe.idleLatestEventTime),oe.idleLatestEventTime=B.currentTimestamp())}catch(e){B.log('ERROR: while reporting queued events. Exception: ',e.stack?e.stack:e.message)}},elapseIdleTimes:function(){oe.idleLatestEventTime=oe.idleBaseTime=B.currentTimestamp()},reportAllCollectedEvents:function(e){if(oe.reporter.gainLockToReport()||e){var t=oe.eventsToReport;oe.eventsToReport=[];try{oe.reportEvents(t,e)}catch(e){B.log('ERROR: while reporting events. Exception: ',e.stack?e.stack:e.message),oe.reporter.freeLock()}oe.freshStartInd=0,G.notifyEventsFlush()}else B.log('reporter not ready yet. postponing '+oe.eventsToReport.length+' events reports.')},reportIdleEvent:function(e){var t=Y.createEventObject('idle',B.currentTimestamp(),null),n=B.currentTimestamp();if(t.value=n-oe.idleBaseTime,t.binding={valueEncoding:K.encodeNumber},t.setExtraInfo(f.prototype.TIME_SINCE_LAST_EVENT,n-e),C.reportAllOnUnload)oe.eventsToReport.push(t);else{var r=[t];oe.reportEvents(r)}},reportEvents:function(e,t){t=t||!1;var n=oe.reporter.config.maxReports;!Y.config.reportByPost&&t&&(n=C.maxReportsWithUnload),oe.encodeAndConcatenateEvents(e,oe.reporter.config.maxReportSize,n)},encodeAndConcatenateEvents:function(e,t,n){var r=null;-1!==n&&e.length>1&&'unload'===e[e.length-1].type&&(r=e.pop());for(var o,i=0,a=[],s='',c=0,l=e[0].getSubPage(),u=e[0].type,d=0;d<e.length;d++){var p=e[d],m=p.getSubPage(),g=l===m,f=p.type,v=u===f,h=H.isUndefined(p.selectorExpression)||null==p.selectorExpression?w.encoding.rootSelector:p.selectorExpression,E=h;if(w.repeatingElementSelector&&!H.isUndefined(w.repeatingElementSelector)&&(h===w.encoding.rootSelector?s='':h===s?(E=w.repeatingElementSelector,s=h):s=h),o=oe.safeEncodeEvent(p,E),H.contains(w.nobelEventTypes,p.type))a.length>0&&oe.flushEvents(a,l),oe.flushEvents([o],m),a=[],c=0,s='',l=m,u=f;else{var y=!(0!==a.length&&!v)||!(H.contains(w.socialNobelEventTypes,p.type)||H.contains(w.socialNobelEventTypes,u)),b=o.length+(0===a.length?0:w.encoding.delimiters.events.length),T=-1===t||beaconEncodingManager.encoder.estimateBeaconSize(c+b)<t;if(g&&T&&y)c+=b,a.push(o);else{if(a.length>0){if(function(){return i++,-1!==n&&i>=n}()){if(null!==r){var S=e.length-d;B.log('Reached max number of reports allowed ('+n+'). Lost '+S+' events.'),r.setExtraInfo(r.LOST_EVENTS_NUM,S),o=beaconEncodingManager.encoder.encodeEvent(r),a.push(o),oe.flushEvents(a,l)}return}oe.flushEvents(a,l),a=[],c=0}E===w.repeatingElementSelector&&(o=oe.safeEncodeEvent(p,h)),-1!==t&&beaconEncodingManager.encoder.estimateBeaconSize(o.length)>t?(oe.flushEvents([o],m),s=''):(a.push(o),c+=o.length)}l=m,u=f}}if(a.length>0){if(null!==r){var C=beaconEncodingManager.encoder.encodeEvent(r);a.push(C)}oe.flushEvents(a,l)}},safeEncodeEvent:function(e,t){try{return beaconEncodingManager.encoder.encodeEvent(e,t)}catch(r){B.log('ERROR: while encoding event: '+e.type+' . Exception: ',r.stack?r.stack:r.message);var n=oe.generateClsdebugEventInstead(e,r);return beaconEncodingManager.encoder.encodeEvent(n,t)}},generateClsdebugEventInstead:function(e,t){var n='';if(void 0!==e.value)try{n=JSON.stringify(e.value),n=B.truncateStr(n,400,!0)}catch(e){n='cannot stringify value because: '+e.message}var r='encoding event: \''+e.type+'\' with value: {'+n+'}',o=Y.formatClsDebugMessage(r,t,'event cancelled');0===o.length&&(o='CLS Error in\tencoding event: \''+e.type+'\' ...');var i=Y.createEventObject('clsdebug',B.currentTimestamp(),null);return i.value=o,i},flushEvents:function(e,t){oe.sequenceNumber++;var n=oe.buildBeaconPayload(t,e,oe.sequenceNumber);oe.reporter.flushEvents(n,oe.sequenceNumber),B.trace('Beacon['+oe.sequenceNumber+' payload-len:'+n.length+']: '+oe.reporter.name+' reported '+e.length+' events'+(t.length>0?' [on '+t+']':''),e)},buildBeaconPayload:function(e,t,n){return beaconEncodingManager.encoder.encodeBeacon(w.beaconVersion,n,oe.pageId,e,-1!==oe.lastPageSnapshotSequence?oe.lastPageSnapshotSequence:r,t)}};Y.registerPlugin('beaconReport',oe),t._detector=Y,Y.initialize()}else void 0!==window.console&&window.console.log}(0,window,document)}
//# sourceMappingURL=./glassbox-ui-capture.js.map